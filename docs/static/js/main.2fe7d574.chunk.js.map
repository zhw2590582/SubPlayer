{"version":3,"sources":["utils/index.js","i18n/index.js","libs/languages.js","libs/Sub.js","libs/readSub/ass2vtt.js","libs/readSub/index.js","libs/readSub/sub2ass.js","libs/googleTranslate.js","components/Tool.js","libs/readSub/srt2vtt.js","components/Subtitles.js","libs/backlight.js","components/Player.js","libs/WFPlayer/emitter.js","libs/WFPlayer/events.js","libs/WFPlayer/utils.js","libs/WFPlayer/template.js","libs/WFPlayer/drawer.js","libs/WFPlayer/decoder.js","libs/WFPlayer/loader.js","libs/WFPlayer/controller.js","libs/WFPlayer/index.js","components/Timeline.js","components/Metronome.js","components/Footer.js","components/Loading.js","App.js","Mobile.js","GlobalStyle.js","index.js"],"names":["userAgent","window","navigator","isMobile","test","getExt","url","trim","toLowerCase","split","pop","sleep","ms","Promise","resolve","setTimeout","getKeyCode","event","tag","document","activeElement","tagName","toUpperCase","editable","getAttribute","Number","keyCode","isPlaying","$video","currentTime","paused","ended","readyState","zh","LOADING","SUB_TEXT","OPEN_VIDEO","OPEN_SUB","EXPORT_ASS","EXPORT_SRT","EXPORT_VTT","TRANSLATE","TRANSLATING","TRANSLAT_SUCCESS","DECODE_START","DECODE_SUCCESS","DECODE_ERROR","VIDEO_EXT_ERR","SUB_EXT_ERR","MOBILE_TIP","HOTKEY_01","HOTKEY_02","CLEAR","UNDO","DELETE","MERGE","SPLIT","i18n","en","name","key","languages","Sub","obj","this","start","end","text","text2","startTime","endTime","DT","t2d","time","d2t","clamp","Infinity","parseFloat","toFixed","ass2vtt","ass","re_ass","RegExp","fixTime","map","item","index","arr","length","join","line","m","match","replace","filter","url2sub","createElement","$track","default","kind","appendChild","onload","Array","from","track","cues","src","vtt2url","vtt","URL","createObjectURL","Blob","type","toSubTime","str","n","sx","x","slice","toString","unshift","Math","floor","translate","query","lang","searchParams","append","reject","fetch","href","then","data","json","catch","err","a","subtitle","result","loop","shift","push","Style","styled","div","reader","FileReader","Header","player","waveform","newSub","undoSubs","clearSubs","language","setLoading","formatSub","setSubtitle","notify","useState","progress","setProgress","setTranslate","transcode","useCallback","file","size","message","t","level","createFFmpeg","FFmpeg","fetchFile","ffmpeg","log","ratio","load","FS","output","Date","now","run","uint8","decoder","decodeAudioData","drawer","update","useEffect","destroy","sampleRate","getChannelData","Float32Array","target","onVideoChange","files","ext","canPlayType","seek","readAsArrayBuffer","onSubtitleChange","includes","sub","JSON","parse","error","concat","readAsText","file2sub","res","onInputClick","value","downloadSub","sub2srt","sub2ass","sub2txt","stringify","elink","style","display","download","body","click","removeChild","onTranslate","googleTranslate","className","width","onChange","onClick","alt","Subtitles","currentIndex","checkSub","updateSub","height","setHeight","resize","clientHeight","init","debounceResize","debounce","addEventListener","headerHeight","rowHeight","scrollToIndex","rowCount","rowGetter","headerRowRenderer","rowRenderer","props","pause","duration","rowData","maxLength","spellCheck","unescape","matrixCallback","callback","xIndex","yIndex","y","backlight","$player","element","styles","$backlight","classList","add","position","zIndex","left","top","right","bottom","Object","keys","forEach","setStyle","parent","matrix","$box","borderRadius","transition","$canvas","clientWidth","ctx","getContext","drawImage","itemW","itemH","itemX","itemY","getImageData","r","g","b","i","l","getColors","boxShadow","insertBefore","requestAnimationFrame","VideoWrap","memo","setPlayer","setCurrentTime","setPlaying","createRef","current","play","ref","Player","currentSub","setCurrentSub","focusing","setFocusing","inputItemCursor","setInputItemCursor","state","useMemo","selectionStart","onFocus","onBlur","onSplit","splitSub","playing","onKeyDown","Emitter","fn","e","self","listener","off","args","apply","_","on","evtArr","evts","liveEvents","len","Events","destroyEvents","proxy","bind","option","isArray","removeEventListener","WFPlayerError","Error","errorHandle","condition","msg","durationToTime","num","max","min","Template","wf","canvas","options","container","pixelRatio","constructor","instances","every","innerHTML","toDataURL","Drawer","template","gridNum","gridGap","beginTime","cursor","grid","ruler","wave","padding","density","1","2","3","4","5","6","7","8","emit","drawBackground","drawGrid","drawRuler","drawWave","drawCursor","backgroundColor","paddingColor","clearRect","fillStyle","fillRect","waveColor","progressColor","waveScale","channelData","audiobuffer","middle","waveWidth","startIndex","endIndex","step","cursorX","stepIndex","waveX","gridColor","parseInt","rulerColor","rulerAtTop","font","second","fillText","fontHeight","cursorColor","Decoder","audioCtx","OfflineAudioContext","webkitOfflineAudioContext","throttleDecodeAudioData","throttle","createBuffer","buffer","decodeSuccess","channel","Loader","fileSize","loadSize","Uint8Array","abortController","AbortController","withCredentials","cors","headers","credentials","mode","signal","response","getReader","get","read","done","byteLength","buffers","Cons","reduce","pre","val","merge","set","mergeBuffer","call","arrayBuffer","cancel","abort","Controller","playTimer","clickInit","resizeInit","playInit","pageX","offsetLeft","events","mediaElement","getTimeFromEvent","throttleResize","isDestroy","cancelAnimationFrame","id","WFPlayer","_currentTime","setOptions","controller","loader","validator","kindOf","querySelector","scheme","HTMLVideoElement","HTMLAudioElement","changeChannel","exportImage","splice","indexOf","ceil","devicePixelRatio","checkNum","isInteger","Timeline","magnetically","closeTime","lastTarget","lastSub","lastType","lastX","lastIndex","lastWidth","lastDiffX","isDroging","React","subs","render","removeSub","hasSub","mergeSub","$blockRef","$subsRef","currentSubs","findIndex","onMouseDown","button","children","onDocumentMouseMove","transform","onDocumentMouseUp","timeDiff","previou","next","onDoubleClick","$subs","currentTarget","holdToDisplay","title","prevProps","nextProps","isEqual","Metronome","Component","addSub","setIsDroging","drogStartTime","setDrogStartTime","drogEndTime","setDrogEndTime","getEventTime","clickTime","onMouseMove","Waveform","setWaveform","setRender","$waveform","Grab","grabStartX","setGrabStartX","grabStartTime","setGrabStartTime","grabbing","setGrabbing","onGrabDown","onGrabUp","onGrabMove","Progress","onProgressClick","Duration","getDuration","Footer","$footer","onWheel","contains","deltaY","sign","onWheelThrottle","Fragment","Loading","loading","App","defaultLang","subtitleHistory","useRef","notificationSystem","setLanguage","setSubtitleOriginal","setCurrentIndex","copySubs","newSubtitle","saveToHistory","localStorage","setItem","previous","check","notification","clearNotifications","addNotification","dismissible","autoDismiss","subClone","assign","text1","splitDuration","middleTime","preventDefault","metaKey","localSubtitleString","getItem","fetchSubtitle","localSubtitle","allowHTML","Mobile","createGlobalStyle","setTranslations","setLocale","ReactDOM","GlobalStyle","getElementById"],"mappings":"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","file":"static/js/main.2fe7d574.chunk.js","sourcesContent":["export const userAgent = window.navigator.userAgent;\nexport const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);\n\nexport function getExt(url) {\n    return url.trim().toLowerCase().split('.').pop();\n}\n\nexport function sleep(ms = 0) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport function download(url, name) {\n    const elink = document.createElement('a');\n    elink.style.display = 'none';\n    elink.href = url;\n    elink.download = name;\n    document.body.appendChild(elink);\n    elink.click();\n    document.body.removeChild(elink);\n}\n\nexport function getKeyCode(event) {\n    const tag = document.activeElement.tagName.toUpperCase();\n    const editable = document.activeElement.getAttribute('contenteditable');\n    if (tag !== 'INPUT' && tag !== 'TEXTAREA' && editable !== '' && editable !== 'true') {\n        return Number(event.keyCode);\n    }\n}\n\nexport function isPlaying($video) {\n    return !!($video.currentTime > 0 && !$video.paused && !$video.ended && $video.readyState > 2);\n}\n","const en = {\n    LOADING: 'Loading...',\n    SUB_TEXT: 'Subtitle Text',\n    OPEN_VIDEO: 'Open Video',\n    OPEN_SUB: 'Open Subtitle',\n    EXPORT_ASS: 'Export ASS',\n    EXPORT_SRT: 'Export SRT',\n    EXPORT_VTT: 'Export VTT',\n    TRANSLATE: 'Translation',\n    TRANSLATING: 'Translation...',\n    TRANSLAT_SUCCESS: 'Translation success',\n    DECODE_START: 'Start decoding audio',\n    DECODE_SUCCESS: 'Decoding audio success',\n    DECODE_ERROR: 'Decoding audio failed',\n    VIDEO_EXT_ERR: 'Unable to open this video format',\n    SUB_EXT_ERR: 'Unable to open this subtitle format',\n    MOBILE_TIP: 'Please use computer access',\n    HOTKEY_01: 'Space: Play / Pause',\n    HOTKEY_02: 'Ctrl + Z: Undo',\n    CLEAR: 'Clear',\n    UNDO: 'Undo',\n    DELETE: 'Delete Subtitle',\n    MERGE: 'Merge Next',\n    SPLIT: 'Split Subtitle',\n};\n\nconst zh = {\n    LOADING: '...',\n    SUB_TEXT: '',\n    OPEN_VIDEO: '',\n    OPEN_SUB: '',\n    EXPORT_ASS: ' ASS',\n    EXPORT_SRT: ' SRT',\n    EXPORT_VTT: ' VTT',\n    TRANSLATE: '',\n    TRANSLATING: '...',\n    TRANSLAT_SUCCESS: '',\n    DECODE_START: '',\n    DECODE_SUCCESS: '',\n    DECODE_ERROR: '',\n    VIDEO_EXT_ERR: '',\n    SUB_EXT_ERR: '',\n    MOBILE_TIP: '',\n    HOTKEY_01: ':  / ',\n    HOTKEY_02: 'Ctrl + Z: ',\n    CLEAR: '',\n    UNDO: '',\n    DELETE: '',\n    MERGE: '',\n    SPLIT: '',\n};\n\nconst i18n = {\n    en,\n    zh,\n    'zh-cn': zh,\n    'zh-tw': zh,\n};\n\nexport default i18n;\n","// https://cloud.google.com/translate/docs/languages\n\nconst zh = [\n    { name: '', key: 'zh' },\n    { name: '', key: 'zh-TW' },\n    { name: '', key: 'en' },\n    { name: '', key: 'af' },\n    { name: '', key: 'sq' },\n    { name: '', key: 'am' },\n    { name: '', key: 'ar' },\n    { name: '', key: 'hy' },\n    { name: '', key: 'az' },\n    { name: '', key: 'eu' },\n    { name: '', key: 'be' },\n    { name: '', key: 'bn' },\n    { name: '', key: 'bs' },\n    { name: '', key: 'bg' },\n    { name: '', key: 'ca' },\n    { name: '', key: 'ceb' },\n    { name: '', key: 'co' },\n    { name: '', key: 'hr' },\n    { name: '', key: 'cs' },\n    { name: '', key: 'da' },\n    { name: '', key: 'nl' },\n    { name: '', key: 'eo' },\n    { name: '', key: 'et' },\n    { name: '', key: 'fi' },\n    { name: '', key: 'fr' },\n    { name: '', key: 'fy' },\n    { name: '', key: 'gl' },\n    { name: '', key: 'ka' },\n    { name: '', key: 'de' },\n    { name: '', key: 'el' },\n    { name: '', key: 'gu' },\n    { name: '', key: 'ht' },\n    { name: '', key: 'ha' },\n    { name: '', key: 'haw' },\n    { name: '', key: 'he' },\n    { name: '', key: 'hi' },\n    { name: '', key: 'hmn' },\n    { name: '', key: 'hu' },\n    { name: '', key: 'is' },\n    { name: '', key: 'ig' },\n    { name: '', key: 'id' },\n    { name: '', key: 'ga' },\n    { name: '', key: 'it' },\n    { name: '', key: 'ja' },\n    { name: '', key: 'jw' },\n    { name: '', key: 'kn' },\n    { name: '', key: 'kk' },\n    { name: '', key: 'km' },\n    { name: '', key: 'ko' },\n    { name: '', key: 'ku' },\n    { name: '', key: 'ky' },\n    { name: '', key: 'lo' },\n    { name: '', key: 'la' },\n    { name: '', key: 'lv' },\n    { name: '', key: 'lt' },\n    { name: '', key: 'lb' },\n    { name: '', key: 'mk' },\n    { name: '', key: 'mg' },\n    { name: '', key: 'ms' },\n    { name: '', key: 'ml' },\n    { name: '', key: 'mt' },\n    { name: '', key: 'mi' },\n    { name: '', key: 'mr' },\n    { name: '', key: 'mn' },\n    { name: '', key: 'my' },\n    { name: '', key: 'ne' },\n    { name: '', key: 'no' },\n    { name: '', key: 'ny' },\n    { name: '', key: 'ps' },\n    { name: '', key: 'fa' },\n    { name: '', key: 'pl' },\n    { name: '', key: 'pt' },\n    { name: '', key: 'pa' },\n    { name: '', key: 'ro' },\n    { name: '', key: 'ru' },\n    { name: '', key: 'sm' },\n    { name: '', key: 'gd' },\n    { name: '', key: 'sr' },\n    { name: '', key: 'st' },\n    { name: '', key: 'sn' },\n    { name: '', key: 'sd' },\n    { name: '', key: 'si' },\n    { name: '', key: 'sk' },\n    { name: '', key: 'sl' },\n    { name: '', key: 'so' },\n    { name: '', key: 'es' },\n    { name: '', key: 'su' },\n    { name: '', key: 'sw' },\n    { name: '', key: 'sv' },\n    { name: '', key: 'tl' },\n    { name: '', key: 'tg' },\n    { name: '', key: 'ta' },\n    { name: '', key: 'te' },\n    { name: '', key: 'th' },\n    { name: '', key: 'tr' },\n    { name: '', key: 'uk' },\n    { name: '', key: 'ur' },\n    { name: '', key: 'uz' },\n    { name: '', key: 'vi' },\n    { name: '', key: 'cy' },\n    { name: '', key: 'xh' },\n    { name: '', key: 'yi' },\n    { name: '', key: 'yo' },\n    { name: '', key: 'zu' },\n];\n\nconst en = [\n    { name: 'Chinese Simplified', key: 'zh' },\n    { name: 'Chinese Traditional', key: 'zh-TW' },\n    { name: 'English', key: 'en' },\n    { name: 'Afrikaans', key: 'af' },\n    { name: 'Albania', key: 'sq' },\n    { name: 'Amharic', key: 'am' },\n    { name: 'Arabic', key: 'ar' },\n    { name: 'Armenian', key: 'hy' },\n    { name: 'Azerbaijani', key: 'az' },\n    { name: 'Basque', key: 'eu' },\n    { name: 'Belarusian', key: 'be' },\n    { name: 'Bengali', key: 'bn' },\n    { name: 'Bosnia', key: 'bs' },\n    { name: 'Bulgarian', key: 'bg' },\n    { name: 'Catalan', key: 'ca' },\n    { name: 'Cebu language', key: 'ceb' },\n    { name: 'Corsican', key: 'co' },\n    { name: 'Croatian', key: 'hr' },\n    { name: 'Czech', key: 'cs' },\n    { name: 'Danish', key: 'da' },\n    { name: 'Dutch', key: 'nl' },\n    { name: 'Esperanto', key: 'eo' },\n    { name: 'Estonian', key: 'et' },\n    { name: 'Finnish', key: 'fi' },\n    { name: 'French', key: 'fr' },\n    { name: 'Friesian', key: 'fy' },\n    { name: 'Galician', key: 'gl' },\n    { name: 'Georgian', key: 'ka' },\n    { name: 'German', key: 'de' },\n    { name: 'Greek', key: 'el' },\n    { name: 'Gujarati', key: 'gu' },\n    { name: 'Haiti Creole', key: 'ht' },\n    { name: 'Hausa', key: 'ha' },\n    { name: 'Hawaiian', key: 'haw' },\n    { name: 'Hebrew', key: 'he' },\n    { name: 'Hindi', key: 'hi' },\n    { name: 'Hmong', key: 'hmn' },\n    { name: 'Hungarian', key: 'hu' },\n    { name: 'Icelandic', key: 'is' },\n    { name: 'Ibo', key: 'ig' },\n    { name: 'Indonesian', key: 'id' },\n    { name: 'Irish', key: 'ga' },\n    { name: 'Italian', key: 'it' },\n    { name: 'Japanese', key: 'ja' },\n    { name: 'Javanese', key: 'jw' },\n    { name: 'Kannada', key: 'kn' },\n    { name: 'Kazakh', key: 'kk' },\n    { name: 'Khmer text', key: 'km' },\n    { name: 'Korean', key: 'ko' },\n    { name: 'Kurdish', key: 'ku' },\n    { name: 'Kyrgyz', key: 'ky' },\n    { name: 'Laotian', key: 'lo' },\n    { name: 'Latin', key: 'la' },\n    { name: 'Latvian', key: 'lv' },\n    { name: 'Lithuania', key: 'lt' },\n    { name: 'Luxembourg', key: 'lb' },\n    { name: 'Macedonian', key: 'mk' },\n    { name: 'Malagasy', key: 'mg' },\n    { name: 'Malay', key: 'ms' },\n    { name: 'Malayalam', key: 'ml' },\n    { name: 'Malta', key: 'mt' },\n    { name: 'Maori', key: 'mi' },\n    { name: 'Marathi', key: 'mr' },\n    { name: 'Mongolian', key: 'mn' },\n    { name: 'Burmese', key: 'my' },\n    { name: 'Nepalese', key: 'ne' },\n    { name: 'Norwegian', key: 'no' },\n    { name: 'Nyanza', key: 'ny' },\n    { name: 'Pashto', key: 'ps' },\n    { name: 'Persian', key: 'fa' },\n    { name: 'Polish', key: 'pl' },\n    { name: 'Portuguese', key: 'pt' },\n    { name: 'Punjabi', key: 'pa' },\n    { name: 'Romanian', key: 'ro' },\n    { name: 'Russian', key: 'ru' },\n    { name: 'Samoan', key: 'sm' },\n    { name: 'Scottish Gaelic', key: 'gd' },\n    { name: 'Serbian', key: 'sr' },\n    { name: 'Sesotho', key: 'st' },\n    { name: 'Shanna', key: 'sn' },\n    { name: 'Sin German', key: 'sd' },\n    { name: 'Sinhala', key: 'si' },\n    { name: 'Slovakian', key: 'sk' },\n    { name: 'Slovenian', key: 'sl' },\n    { name: 'Somali', key: 'so' },\n    { name: 'Spanish', key: 'es' },\n    { name: 'Sundanese', key: 'su' },\n    { name: 'Swahili', key: 'sw' },\n    { name: 'Swedish', key: 'sv' },\n    { name: 'Tagalogian', key: 'tl' },\n    { name: 'Tajik', key: 'tg' },\n    { name: 'Tamil', key: 'ta' },\n    { name: 'Telugu', key: 'te' },\n    { name: 'Thai', key: 'th' },\n    { name: 'Turkish', key: 'tr' },\n    { name: 'Ukrainian', key: 'uk' },\n    { name: 'Urdu', key: 'ur' },\n    { name: 'Uzbek', key: 'uz' },\n    { name: 'Vietnamese', key: 'vi' },\n    { name: 'Welsh', key: 'cy' },\n    { name: 'bantu', key: 'xh' },\n    { name: 'Yiddish', key: 'yi' },\n    { name: 'Yoruba', key: 'yo' },\n    { name: 'zulu', key: 'zu' },\n];\n\nconst languages = {\n    en,\n    zh,\n    'zh-cn': zh,\n    'zh-tw': zh,\n};\n\nexport default languages;\n","import clamp from 'lodash/clamp';\nimport DT from 'duration-time-conversion';\n\nexport default class Sub {\n    constructor(obj) {\n        this.start = obj.start;\n        this.end = obj.end;\n        this.text = obj.text;\n        this.text2 = obj.text2;\n    }\n\n    get check() {\n        return this.startTime >= 0 && this.endTime >= 0 && this.startTime < this.endTime;\n    }\n\n    get clone() {\n        return new Sub(this);\n    }\n\n    get startTime() {\n        return DT.t2d(this.start);\n    }\n\n    set startTime(time) {\n        this.start = DT.d2t(clamp(time, 0, Infinity));\n    }\n\n    get endTime() {\n        return DT.t2d(this.end);\n    }\n\n    set endTime(time) {\n        this.end = DT.d2t(clamp(time, 0, Infinity));\n    }\n\n    get duration() {\n        return parseFloat((this.endTime - this.startTime).toFixed(3));\n    }\n}\n","export default function ass2vtt(ass) {\n    const re_ass = new RegExp(\n        'Dialogue:\\\\s\\\\d,' +\n            '(\\\\d+:\\\\d\\\\d:\\\\d\\\\d.\\\\d\\\\d),' +\n            '(\\\\d+:\\\\d\\\\d:\\\\d\\\\d.\\\\d\\\\d),' +\n            '([^,]*),' +\n            '([^,]*),' +\n            '(?:[^,]*,){4}' +\n            '([\\\\s\\\\S]*)$',\n        'i',\n    );\n\n    function fixTime(time = '') {\n        return time\n            .split(/[:.]/)\n            .map((item, index, arr) => {\n                if (index === arr.length - 1) {\n                    if (item.length === 1) {\n                        return '.' + item + '00';\n                    } else if (item.length === 2) {\n                        return '.' + item + '0';\n                    }\n                } else {\n                    if (item.length === 1) {\n                        return (index === 0 ? '0' : ':0') + item;\n                    }\n                }\n\n                return index === 0 ? item : index === arr.length - 1 ? '.' + item : ':' + item;\n            })\n            .join('');\n    }\n\n    return (\n        'WEBVTT\\n\\n' +\n        ass\n            .split(/\\r?\\n/)\n            .map((line) => {\n                const m = line.match(re_ass);\n                if (!m) return null;\n                return {\n                    start: fixTime(m[1].trim()),\n                    end: fixTime(m[2].trim()),\n                    text: m[5]\n                        .replace(/{[\\s\\S]*?}/g, '')\n                        .replace(/(\\\\N)/g, '\\n')\n                        .trim()\n                        .split(/\\r?\\n/)\n                        .map((item) => item.trim())\n                        .join('\\n'),\n                };\n            })\n            .filter((line) => line)\n            .map((line, index) => {\n                if (line) {\n                    return index + 1 + '\\n' + line.start + ' --> ' + line.end + '\\n' + line.text;\n                } else {\n                    return '';\n                }\n            })\n            .filter((line) => line.trim())\n            .join('\\n\\n')\n    );\n}\n","import DT from 'duration-time-conversion';\nimport { getExt } from '../../utils';\nimport Sub from '../Sub';\nimport ass2vtt from './ass2vtt';\nimport srt2vtt from './srt2vtt';\n\nexport function url2sub(url) {\n    return new Promise((resolve) => {\n        const $video = document.createElement('video');\n        const $track = document.createElement('track');\n        $track.default = true;\n        $track.kind = 'metadata';\n        $video.appendChild($track);\n        $track.onload = () => {\n            resolve(\n                Array.from($track.track.cues).map((item) => {\n                    const start = DT.d2t(item.startTime);\n                    const end = DT.d2t(item.endTime);\n                    const text = item.text;\n                    return new Sub({ start, end, text });\n                }),\n            );\n        };\n        $track.src = url;\n    });\n}\n\nexport function vtt2url(vtt) {\n    return URL.createObjectURL(\n        new Blob([vtt], {\n            type: 'text/vtt',\n        }),\n    );\n}\n\nexport function file2sub(file) {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = async () => {\n            const ext = getExt(file.name);\n            if (ext === 'json') {\n                try {\n                    const sub = JSON.parse(reader.result).map((item) => new Sub(item));\n                    resolve(sub);\n                } catch (error) {\n                    reject(error);\n                }\n            } else {\n                const text = reader.result.replace(/{[\\s\\S]*?}/g, '');\n                switch (ext) {\n                    case 'vtt': {\n                        const url = vtt2url(text);\n                        const sub = await url2sub(url);\n                        resolve(sub);\n                        break;\n                    }\n                    case 'ass': {\n                        const vtt = ass2vtt(text);\n                        const url = vtt2url(vtt);\n                        const sub = await url2sub(url);\n                        resolve(sub);\n                        break;\n                    }\n                    case 'srt': {\n                        const vtt = srt2vtt(text);\n                        const url = vtt2url(vtt);\n                        const sub = await url2sub(url);\n                        resolve(sub);\n                        break;\n                    }\n                    case 'json': {\n                        const sub = JSON.parse(text).map((item) => new Sub(item));\n                        resolve(sub);\n                        break;\n                    }\n                    default:\n                        resolve([]);\n                        break;\n                }\n            }\n        };\n        reader.readAsText(file);\n    });\n}\n\nexport function sub2vtt(sub) {\n    return (\n        'WEBVTT\\n\\n' +\n        sub\n            .map((item, index) => {\n                return index + 1 + '\\n' + item.start + ' --> ' + item.end + '\\n' + item.text;\n            })\n            .join('\\n\\n')\n    );\n}\n\nexport function sub2srt(sub) {\n    return sub\n        .map((item, index) => {\n            return `${index + 1}\\n${item.start.replace('.', ',')} --> ${item.end.replace('.', ',')}\\n${item.text}`;\n        })\n        .join('\\n\\n');\n}\n\nexport function sub2txt(sub) {\n    return sub.map((item) => item.text).join('\\n\\n');\n}\n","const toSubTime = (str) => {\n    let n = [];\n    let sx = '';\n    let x = str.split(/[:.]/).map((x) => Number(x));\n    x = str.split(/[:.]/).map((x) => Number(x));\n    x[3] = '0.' + ('00' + x[3]).slice(-3);\n    sx = (x[0] * 60 * 60 + x[1] * 60 + x[2] + Number(x[3])).toFixed(2);\n    sx = sx.toString().split('.');\n    n.unshift(sx[1]);\n    sx = Number(sx[0]);\n    n.unshift(('0' + (sx % 60).toString()).slice(-2));\n    n.unshift(('0' + (Math.floor(sx / 60) % 60).toString()).slice(-2));\n    n.unshift((Math.floor(sx / 3600) % 60).toString());\n    return n.slice(0, 3).join(':') + '.' + n[3];\n};\n\nexport default function sub2ass(sub) {\n    return `\n[Script Info]\n; // \nSynch Point:1\nScriptType:v4.00+\nCollisions:Normal\n\n[V4+ Styles]\nFormat: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding\nStyle: Default, Microsoft YaHei, 20, &H00FFFFFF, &H000000FF, &H00000000, &H00000000, 0, 0, 0, 0, 100, 100, 0, 0, 1, 1, 0, 2, 10, 10, 10, 134\n\n[Events]\nFormat: Layer, Start, End, Style, Actor, MarginL, MarginR, MarginV, Effect, Text\n${sub\n    .map((item) => {\n        const start = toSubTime(item.start);\n        const end = toSubTime(item.end);\n        const text = item.text.replace(/\\r?\\n/g, '\\\\N');\n        return `Dialogue: 0,${start},${end},Default,NTP,0000,0000,0000,,${text}`;\n    })\n    .join('\\n')}\n    `.trim();\n}\n","import { sleep } from '../utils';\n\nfunction translate(query = '', lang) {\n    if (!query.trim()) return Promise.resolve('');\n    const url = new URL('https://translate.googleapis.com/translate_a/single');\n    url.searchParams.append('client', 'gtx');\n    url.searchParams.append('sl', 'auto');\n    url.searchParams.append('dt', 't');\n    url.searchParams.append('tl', lang);\n    url.searchParams.append('q', query);\n\n    return new Promise((resolve, reject) => {\n        fetch(url.href)\n            .then((data) => data.json())\n            .then((data) => {\n                if (data) {\n                    resolve(data[0].map((item) => item[0].trim()).join('\\n'));\n                } else {\n                    resolve('');\n                }\n            })\n            .catch((err) => {\n                reject(err);\n            });\n    });\n}\n\nexport default async function googleTranslate(subtitle = [], lang) {\n    return new Promise((resolve, reject) => {\n        const result = [];\n        (function loop() {\n            const item = subtitle.shift();\n            if (item) {\n                translate(item.text, lang)\n                    .then((text) => {\n                        item.text = text;\n                        result.push(item);\n                        sleep(100).then(loop);\n                    })\n                    .catch((err) => {\n                        reject(err);\n                    });\n            } else {\n                resolve(result);\n            }\n        })();\n    });\n}\n","import styled from 'styled-components';\nimport languages from '../libs/languages';\nimport { t, Translate } from 'react-i18nify';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { getExt, download } from '../utils';\nimport { file2sub, sub2vtt, sub2srt, sub2txt } from '../libs/readSub';\nimport sub2ass from '../libs/readSub/sub2ass';\nimport googleTranslate from '../libs/googleTranslate';\nimport FFmpeg from '@ffmpeg/ffmpeg';\n\nconst Style = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding-bottom: 20px;\n    position: relative;\n    background-color: rgb(0 0 0 / 100%);\n    border-left: 1px solid rgb(255 255 255 / 20%);\n\n    .import {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px;\n        border-bottom: 1px solid rgb(255 255 255 / 20%);\n\n        .btn {\n            position: relative;\n            opacity: 0.85;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 35px;\n            width: 48%;\n            border-radius: 3px;\n            color: #fff;\n            cursor: pointer;\n            font-size: 14px;\n            background-color: #3f51b5;\n            transition: all 0.2s ease 0s;\n\n            &:hover {\n                opacity: 1;\n            }\n        }\n\n        .file {\n            position: absolute;\n            left: 0;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            width: 100%;\n            height: 100%;\n            opacity: 0;\n        }\n    }\n\n    .export {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px;\n        border-bottom: 1px solid rgb(255 255 255 / 20%);\n\n        .btn {\n            position: relative;\n            opacity: 0.85;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 35px;\n            width: 31%;\n            border-radius: 3px;\n            color: #fff;\n            cursor: pointer;\n            font-size: 14px;\n            background-color: #009688;\n            transition: all 0.2s ease 0s;\n\n            &:hover {\n                opacity: 1;\n            }\n        }\n    }\n\n    .operate {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px;\n        border-bottom: 1px solid rgb(255 255 255 / 20%);\n\n        .btn {\n            position: relative;\n            opacity: 0.85;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 35px;\n            width: 48%;\n            border-radius: 3px;\n            color: #fff;\n            cursor: pointer;\n            font-size: 14px;\n            background-color: #009688;\n            transition: all 0.2s ease 0s;\n\n            &:hover {\n                opacity: 1;\n            }\n        }\n    }\n\n    .translate {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px;\n        border-bottom: 1px solid rgb(255 255 255 / 20%);\n\n        select {\n            width: 65%;\n            outline: none;\n            padding: 0 5px;\n            border-radius: 3px;\n        }\n\n        .btn {\n            opacity: 0.85;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 35px;\n            width: 33%;\n            border-radius: 3px;\n            color: #fff;\n            cursor: pointer;\n            font-size: 14px;\n            background-color: #673ab7;\n            transition: all 0.2s ease 0s;\n\n            &:hover {\n                opacity: 1;\n            }\n        }\n    }\n\n    .hotkey {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px;\n\n        span {\n            width: 49%;\n            font-size: 13px;\n            padding: 5px 0;\n            border-radius: 3px;\n            text-align: center;\n            color: rgb(255 255 255 / 75%);\n            background-color: rgb(255 255 255 / 20%);\n        }\n    }\n\n    .bottom {\n        padding: 10px;\n        a {\n            display: flex;\n            flex-direction: column;\n            border: 1px solid rgb(255 255 255 / 30%);\n            text-decoration: none;\n\n            .title {\n                color: #ffeb3b;\n                padding: 5px 10px;\n                animation: animation 3s infinite;\n                border-bottom: 1px solid rgb(255 255 255 / 30%);\n            }\n\n            @keyframes animation {\n                50% {\n                    color: #00bcd4;\n                }\n            }\n\n            img {\n                max-width: 100%;\n            }\n        }\n    }\n\n    .progress {\n        position: fixed;\n        left: 0;\n        top: 0;\n        right: 0;\n        z-index: 9;\n        height: 2px;\n        background-color: rgb(0 0 0 / 50%);\n\n        span {\n            display: inline-block;\n            position: absolute;\n            left: 0;\n            top: 0;\n            bottom: 0;\n            width: 0;\n            height: 100%;\n            background-color: #ff9800;\n            transition: all 0.2s ease 0s;\n        }\n    }\n`;\n\nconst reader = new FileReader();\nexport default function Header({\n    player,\n    waveform,\n    newSub,\n    undoSubs,\n    clearSubs,\n    language,\n    subtitle,\n    setLoading,\n    formatSub,\n    setSubtitle,\n    notify,\n}) {\n    const [progress, setProgress] = useState(0);\n    const [translate, setTranslate] = useState('en');\n\n    const transcode = useCallback(\n        async (file) => {\n            if (file.size > 256 * 1024 * 1024) return;\n            try {\n                notify({\n                    message: t('DECODE_START'),\n                    level: 'info',\n                });\n                const { createFFmpeg, fetchFile } = FFmpeg;\n                const ffmpeg = createFFmpeg({ log: true });\n                ffmpeg.setProgress(({ ratio }) => setProgress(ratio));\n                await ffmpeg.load();\n                ffmpeg.FS('writeFile', file.name, await fetchFile(file));\n                const output = `${Date.now()}.mp3`;\n                await ffmpeg.run('-i', file.name, '-ac', '1', '-ar', '8000', output);\n                const uint8 = ffmpeg.FS('readFile', output);\n                // download(URL.createObjectURL(new Blob([uint8])), `${output}`);\n                await waveform.decoder.decodeAudioData(uint8);\n                // download(URL.createObjectURL(new Blob([waveform.decoder.channelData])), `${Date.now()}.pcm`);\n                waveform.drawer.update();\n                setProgress(0);\n                ffmpeg.setProgress(() => null);\n                notify({\n                    message: t('DECODE_SUCCESS'),\n                    level: 'success',\n                });\n            } catch (error) {\n                setProgress(0);\n                notify({\n                    message: t('DECODE_ERROR'),\n                    level: 'error',\n                });\n            }\n        },\n        [waveform, notify],\n    );\n\n    useEffect(() => {\n        if (waveform && !reader.onload) {\n            reader.onload = (event) => {\n                waveform.decoder.destroy();\n                waveform.drawer.update();\n                waveform.load({\n                    sampleRate: 44100,\n                    getChannelData() {\n                        return new Float32Array(event.target.result);\n                    },\n                });\n            };\n        }\n    }, [waveform]);\n\n    const onVideoChange = useCallback(\n        (event) => {\n            const file = event.target.files[0];\n            if (file) {\n                const ext = getExt(file.name);\n                const canPlayType = player.canPlayType(file.type);\n                if (canPlayType === 'maybe' || canPlayType === 'probably') {\n                    transcode(file);\n                    const url = URL.createObjectURL(new Blob([file]));\n                    waveform.decoder.destroy();\n                    waveform.drawer.update();\n                    waveform.seek(0);\n                    player.currentTime = 0;\n                    clearSubs();\n                    setSubtitle([\n                        newSub({\n                            start: '00:00:00.000',\n                            end: '00:00:01.000',\n                            text: t('SUB_TEXT'),\n                        }),\n                    ]);\n                    player.src = url;\n                } else if (ext === 'pcm') {\n                    reader.readAsArrayBuffer(file);\n                } else {\n                    notify({\n                        message: `${t('VIDEO_EXT_ERR')}: ${file.type || ext}`,\n                        level: 'error',\n                    });\n                }\n            }\n        },\n        [newSub, notify, player, setSubtitle, waveform, clearSubs, transcode],\n    );\n\n    const onSubtitleChange = useCallback(\n        (event) => {\n            const file = event.target.files[0];\n            if (file) {\n                const ext = getExt(file.name);\n                if (['ass', 'vtt', 'srt', 'json'].includes(ext)) {\n                    file2sub(file)\n                        .then((res) => {\n                            clearSubs();\n                            setSubtitle(res);\n                        })\n                        .catch((err) => {\n                            notify({\n                                message: err.message,\n                                level: 'error',\n                            });\n                        });\n                } else {\n                    notify({\n                        message: `${t('SUB_EXT_ERR')}: ${ext}`,\n                        level: 'error',\n                    });\n                }\n            }\n        },\n        [notify, setSubtitle, clearSubs],\n    );\n\n    const onInputClick = useCallback((event) => {\n        event.target.value = '';\n    }, []);\n\n    const downloadSub = useCallback(\n        (type) => {\n            let text = '';\n            const name = `${Date.now()}.${type}`;\n            switch (type) {\n                case 'vtt':\n                    text = sub2vtt(subtitle);\n                    break;\n                case 'srt':\n                    text = sub2srt(subtitle);\n                    break;\n                case 'ass':\n                    text = sub2ass(subtitle);\n                    break;\n                case 'txt':\n                    text = sub2txt(subtitle);\n                    break;\n                case 'json':\n                    text = JSON.stringify(subtitle);\n                    break;\n                default:\n                    break;\n            }\n            const url = URL.createObjectURL(new Blob([text]));\n            download(url, name);\n        },\n        [subtitle],\n    );\n\n    const onTranslate = useCallback(() => {\n        setLoading(t('TRANSLATING'));\n        googleTranslate(formatSub(subtitle), translate)\n            .then((res) => {\n                setLoading('');\n                setSubtitle(formatSub(res));\n                notify({\n                    message: t('TRANSLAT_SUCCESS'),\n                    level: 'success',\n                });\n            })\n            .catch((err) => {\n                setLoading('');\n                notify({\n                    message: err.message,\n                    level: 'error',\n                });\n            });\n    }, [subtitle, setLoading, formatSub, setSubtitle, translate, notify]);\n\n    return (\n        <Style className=\"tool\">\n            {![0, 1].includes(progress) ? (\n                <div className=\"progress\">\n                    <span style={{ width: `${progress * 100}%` }}></span>\n                </div>\n            ) : null}\n            <div className=\"top\">\n                <div className=\"import\">\n                    <div className=\"btn\">\n                        <Translate value=\"OPEN_VIDEO\" />\n                        <input className=\"file\" type=\"file\" onChange={onVideoChange} onClick={onInputClick} />\n                    </div>\n                    <div className=\"btn\">\n                        <Translate value=\"OPEN_SUB\" />\n                        <input className=\"file\" type=\"file\" onChange={onSubtitleChange} onClick={onInputClick} />\n                    </div>\n                </div>\n                <div className=\"export\">\n                    <div className=\"btn\" onClick={() => downloadSub('ass')}>\n                        <Translate value=\"EXPORT_ASS\" />\n                    </div>\n                    <div className=\"btn\" onClick={() => downloadSub('srt')}>\n                        <Translate value=\"EXPORT_SRT\" />\n                    </div>\n                    <div className=\"btn\" onClick={() => downloadSub('vtt')}>\n                        <Translate value=\"EXPORT_VTT\" />\n                    </div>\n                </div>\n                <div className=\"operate\">\n                    <div className=\"btn\" onClick={clearSubs}>\n                        <Translate value=\"CLEAR\" />\n                    </div>\n                    <div className=\"btn\" onClick={undoSubs}>\n                        <Translate value=\"UNDO\" />\n                    </div>\n                </div>\n                <div className=\"translate\">\n                    <select value={translate} onChange={(event) => setTranslate(event.target.value)}>\n                        {(languages[language] || languages.en).map((item) => (\n                            <option key={item.key} value={item.key}>\n                                {item.name}\n                            </option>\n                        ))}\n                    </select>\n                    <div className=\"btn\" onClick={onTranslate}>\n                        <Translate value=\"TRANSLATE\" />\n                    </div>\n                </div>\n                <div className=\"hotkey\">\n                    <span>\n                        <Translate value=\"HOTKEY_01\" />\n                    </span>\n                    <span>\n                        <Translate value=\"HOTKEY_02\" />\n                    </span>\n                </div>\n            </div>\n            <div className=\"bottom\">\n                <a href=\"https://online.aimu-app.com/\">\n                    <div className=\"title\"></div>\n                    <img src=\"/aimu.png\" alt=\"aimu\" />\n                </a>\n            </div>\n        </Style>\n    );\n}\n","export default function srt2vtt(srt) {\n    return 'WEBVTT \\r\\n\\r\\n'.concat(\n        srt\n            .replace(/\\{\\\\([ibu])\\}/g, '</$1>')\n            .replace(/\\{\\\\([ibu])1\\}/g, '<$1>')\n            .replace(/\\{([ibu])\\}/g, '<$1>')\n            .replace(/\\{\\/([ibu])\\}/g, '</$1>')\n            .replace(/(\\d\\d:\\d\\d:\\d\\d),(\\d\\d\\d)/g, '$1.$2')\n            .replace(/{[\\s\\S]*?}/g, '')\n            .concat('\\r\\n\\r\\n'),\n    );\n}\n","import styled from 'styled-components';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { Table } from 'react-virtualized';\nimport unescape from 'lodash/unescape';\nimport debounce from 'lodash/debounce';\n\nconst Style = styled.div`\n    position: relative;\n    box-shadow: 0px 5px 25px 5px rgb(0 0 0 / 80%);\n    background-color: rgb(0 0 0 / 100%);\n\n    .ReactVirtualized__Table {\n        .ReactVirtualized__Table__Grid {\n            outline: none;\n        }\n\n        .ReactVirtualized__Table__row {\n            .item {\n                height: 100%;\n                padding: 5px;\n\n                .textarea {\n                    border: none;\n                    width: 100%;\n                    height: 100%;\n                    color: #fff;\n                    font-size: 12px;\n                    padding: 10px;\n                    text-align: center;\n                    background-color: rgba(255, 255, 255, 0.05);\n                    border: 1px solid rgba(255, 255, 255, 0.1);\n                    transition: all 0.2s ease;\n                    resize: none;\n                    outline: none;\n\n                    &.highlight {\n                        background-color: rgb(0 87 158);\n                        border: 1px solid rgba(255, 255, 255, 0.3);\n                    }\n\n                    &.illegal {\n                        background-color: rgb(123 29 0);\n                        border: 1px solid rgba(255, 255, 255, 0.3);\n                    }\n                }\n            }\n        }\n    }\n`;\n\nexport default function Subtitles({ currentIndex, subtitle, checkSub, player, updateSub }) {\n    const [height, setHeight] = useState(100);\n\n    const resize = useCallback(() => {\n        setHeight(document.body.clientHeight - 170);\n    }, [setHeight]);\n\n    useEffect(() => {\n        resize();\n        if (!resize.init) {\n            resize.init = true;\n            const debounceResize = debounce(resize, 500);\n            window.addEventListener('resize', debounceResize);\n        }\n    }, [resize]);\n\n    return (\n        <Style className=\"subtitles\">\n            <Table\n                headerHeight={40}\n                width={250}\n                height={height}\n                rowHeight={80}\n                scrollToIndex={currentIndex}\n                rowCount={subtitle.length}\n                rowGetter={({ index }) => subtitle[index]}\n                headerRowRenderer={() => null}\n                rowRenderer={(props) => {\n                    return (\n                        <div\n                            key={props.key}\n                            className={props.className}\n                            style={props.style}\n                            onClick={() => {\n                                if (player) {\n                                    player.pause();\n                                    if (player.duration >= props.rowData.startTime) {\n                                        player.currentTime = props.rowData.startTime + 0.001;\n                                    }\n                                }\n                            }}\n                        >\n                            <div className=\"item\">\n                                <textarea\n                                    maxLength={200}\n                                    spellCheck={false}\n                                    className={[\n                                        'textarea',\n                                        currentIndex === props.index ? 'highlight' : '',\n                                        checkSub(props.rowData) ? 'illegal' : '',\n                                    ]\n                                        .join(' ')\n                                        .trim()}\n                                    value={unescape(props.rowData.text)}\n                                    onChange={(event) => {\n                                        updateSub(props.rowData, {\n                                            text: event.target.value,\n                                        });\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    );\n                }}\n            ></Table>\n        </Style>\n    );\n}\n","import { isPlaying } from '../utils';\n\nfunction matrixCallback(callback) {\n    const result = [];\n    const x = 10;\n    const y = 5;\n    for (let xIndex = 0; xIndex < x; xIndex += 1) {\n        for (let yIndex = 0; yIndex < y; yIndex += 1) {\n            if (xIndex === 0 || xIndex === x - 1 || yIndex === 0 || yIndex === y - 1) {\n                result.push(callback(xIndex, yIndex, x, y));\n            }\n        }\n    }\n    return result;\n}\n\nfunction getColors($canvas, $video, width, height) {\n    const ctx = $canvas.getContext('2d');\n    $canvas.width = width;\n    $canvas.height = height;\n    ctx.drawImage($video, 0, 0);\n    return matrixCallback((xIndex, yIndex, x, y) => {\n        const itemW = width / x;\n        const itemH = height / y;\n        const itemX = xIndex * itemW;\n        const itemY = yIndex * itemH;\n        const { data } = ctx.getImageData(itemX, itemY, itemW, itemH);\n        let r = 0;\n        let g = 0;\n        let b = 0;\n        for (let i = 0, l = data.length; i < l; i += 4) {\n            r += data[i];\n            g += data[i + 1];\n            b += data[i + 2];\n        }\n        r = Math.floor(r / (data.length / 4));\n        g = Math.floor(g / (data.length / 4));\n        b = Math.floor(b / (data.length / 4));\n        return { r, g, b };\n    });\n}\n\nfunction creatMatrix(parent) {\n    return matrixCallback((xIndex, yIndex, x, y) => {\n        const $box = document.createElement('div');\n        $box.style.position = 'absolute';\n        $box.style.left = `${(xIndex * 100) / x}%`;\n        $box.style.top = `${(yIndex * 100) / y}%`;\n        $box.style.width = `${100 / x}%`;\n        $box.style.height = `${100 / y}%`;\n        $box.style.borderRadius = '50%';\n        $box.style.transition = 'all .2s ease';\n        parent.appendChild($box);\n        return {\n            $box,\n            left: xIndex === 0,\n            right: xIndex === x - 1,\n            top: yIndex === 0,\n            bottom: yIndex === y - 1,\n        };\n    });\n}\n\nfunction setStyle(element, key, value) {\n    element.style[key] = value;\n    return element;\n}\n\nfunction setStyles(element, styles) {\n    Object.keys(styles).forEach((key) => {\n        setStyle(element, key, styles[key]);\n    });\n    return element;\n}\n\nexport default function backlight($player, $video) {\n    const $backlight = document.createElement('div');\n    $backlight.classList.add('backlight');\n    setStyles($backlight, {\n        position: 'absolute',\n        zIndex: 9,\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        width: '100%',\n        height: '100%',\n    });\n\n    const matrix = creatMatrix($backlight);\n    const $canvas = document.createElement('canvas');\n    $player.insertBefore($backlight, $video);\n\n    function run() {\n        const { clientWidth, clientHeight } = $video;\n        const colors = getColors($canvas, $video, clientWidth, clientHeight);\n        colors.forEach(({ r, g, b }, index) => {\n            const { $box, left, right, top, bottom } = matrix[index];\n            const x = left ? '-64px' : right ? '64px' : '0';\n            const y = top ? '-64px' : bottom ? '64px' : '0';\n            $box.style.boxShadow = `rgb(${r}, ${g}, ${b}) ${x} ${y} 128px`;\n        });\n    }\n\n    $video.addEventListener('seeked', run);\n    $video.addEventListener('loadedmetadata', () => setTimeout(run, 1000));\n\n    (function loop() {\n        window.requestAnimationFrame(() => {\n            if (isPlaying($video)) {\n                run();\n            }\n            loop();\n        });\n    })();\n}\n","import React, { useState, useEffect, createRef, useCallback, useMemo, memo } from 'react';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { Translate } from 'react-i18nify';\nimport styled from 'styled-components';\nimport backlight from '../libs/backlight';\nimport { isPlaying } from '../utils';\n\nconst Style = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    width: 100%;\n    padding: 20% 10%;\n\n    .video {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        height: auto;\n        width: auto;\n        position: relative;\n\n        video {\n            position: relative;\n            z-index: 10;\n            outline: none;\n            max-height: 100%;\n            max-width: 100%;\n            box-shadow: 0px 5px 25px 5px rgb(0 0 0 / 80%);\n            background-color: #000;\n            cursor: pointer;\n        }\n\n        .subtitle {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            position: absolute;\n            z-index: 20;\n            left: 0;\n            right: 0;\n            bottom: 5%;\n            width: 100%;\n            padding: 0 20px;\n            user-select: none;\n            pointer-events: none;\n\n            .operate {\n                padding: 5px 15px;\n                color: #fff;\n                font-size: 13px;\n                border-radius: 3px;\n                margin-bottom: 5px;\n                background-color: rgb(0 0 0 / 75%);\n                border: 1px solid rgb(255 255 255 / 20%);\n                cursor: pointer;\n                pointer-events: all;\n            }\n\n            .textarea {\n                width: 100%;\n                outline: none;\n                resize: none;\n                text-align: center;\n                line-height: 1.2;\n                border: none;\n                color: #fff;\n                font-size: 20px;\n                padding: 5px 10px;\n                user-select: all;\n                pointer-events: all;\n                background-color: rgb(0 0 0 / 0);\n                text-shadow: rgb(0 0 0) 1px 0px 1px, rgb(0 0 0) 0px 1px 1px, rgb(0 0 0) -1px 0px 1px,\n                    rgb(0 0 0) 0px -1px 1px;\n\n                &.pause {\n                    background-color: rgb(0 0 0 / 50%);\n                }\n            }\n        }\n    }\n`;\n\nconst VideoWrap = memo(\n    ({ setPlayer, setCurrentTime, setPlaying }) => {\n        const $video = createRef();\n\n        useEffect(() => {\n            setPlayer($video.current);\n            (function loop() {\n                window.requestAnimationFrame(() => {\n                    if ($video.current) {\n                        setPlaying(isPlaying($video.current));\n                        setCurrentTime($video.current.currentTime || 0);\n                    }\n                    loop();\n                });\n            })();\n        }, [setPlayer, setCurrentTime, setPlaying, $video]);\n\n        const onClick = useCallback(() => {\n            if ($video.current) {\n                if (isPlaying($video.current)) {\n                    $video.current.pause();\n                } else {\n                    $video.current.play();\n                }\n            }\n        }, [$video]);\n\n        return <video onClick={onClick} src=\"/sample.mp4?t=1\" ref={$video} />;\n    },\n    () => true,\n);\n\nexport default function Player(props) {\n    const [currentSub, setCurrentSub] = useState(null);\n    const [focusing, setFocusing] = useState(false);\n    const [inputItemCursor, setInputItemCursor] = useState(0);\n    const $player = createRef();\n\n    useEffect(() => {\n        if ($player.current && props.player && !backlight.state) {\n            backlight.state = true;\n            backlight($player.current, props.player);\n        }\n    }, [$player, props.player]);\n\n    useMemo(() => {\n        setCurrentSub(props.subtitle[props.currentIndex]);\n    }, [props.subtitle, props.currentIndex]);\n\n    const onChange = useCallback(\n        (event) => {\n            props.player.pause();\n            props.updateSub(currentSub, { text: event.target.value });\n            if (event.target.selectionStart) {\n                setInputItemCursor(event.target.selectionStart);\n            }\n        },\n        [props, currentSub],\n    );\n\n    const onClick = useCallback(\n        (event) => {\n            props.player.pause();\n            if (event.target.selectionStart) {\n                setInputItemCursor(event.target.selectionStart);\n            }\n        },\n        [props],\n    );\n\n    const onFocus = useCallback((event) => {\n        setFocusing(true);\n        if (event.target.selectionStart) {\n            setInputItemCursor(event.target.selectionStart);\n        }\n    }, []);\n\n    const onBlur = useCallback(() => {\n        setTimeout(() => setFocusing(false), 500);\n    }, []);\n\n    const onSplit = useCallback(() => {\n        props.splitSub(currentSub, inputItemCursor);\n    }, [props, currentSub, inputItemCursor]);\n\n    return (\n        <Style className=\"player\">\n            <div className=\"video\" ref={$player}>\n                <VideoWrap {...props} />\n                {props.player && currentSub ? (\n                    <div className=\"subtitle\">\n                        {focusing ? (\n                            <div className=\"operate\" onClick={onSplit}>\n                                <Translate value=\"SPLIT\" />\n                            </div>\n                        ) : null}\n                        <TextareaAutosize\n                            className={`textarea ${!props.playing ? 'pause' : ''}`}\n                            value={currentSub.text}\n                            onChange={onChange}\n                            onClick={onClick}\n                            onFocus={onFocus}\n                            onBlur={onBlur}\n                            onKeyDown={onFocus}\n                            spellCheck={false}\n                        />\n                    </div>\n                ) : null}\n            </div>\n        </Style>\n    );\n}\n","export default class Emitter {\n    on(name, fn, ctx) {\n        const e = this.e || (this.e = {});\n        (e[name] || (e[name] = [])).push({ fn, ctx });\n        return this;\n    }\n\n    once(name, fn, ctx) {\n        const self = this;\n        function listener(...args) {\n            self.off(name, listener);\n            fn.apply(ctx, args);\n        }\n        listener._ = fn;\n        return this.on(name, listener, ctx);\n    }\n\n    emit(name, ...data) {\n        const evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n        for (let i = 0; i < evtArr.length; i += 1) {\n            evtArr[i].fn.apply(evtArr[i].ctx, data);\n        }\n        return this;\n    }\n\n    off(name, callback) {\n        const e = this.e || (this.e = {});\n        const evts = e[name];\n        const liveEvents = [];\n        if (evts && callback) {\n            for (let i = 0, len = evts.length; i < len; i += 1) {\n                if (evts[i].fn !== callback && evts[i].fn._ !== callback) liveEvents.push(evts[i]);\n            }\n        }\n        if (liveEvents.length) {\n            e[name] = liveEvents;\n        } else {\n            delete e[name];\n        }\n        return this;\n    }\n}\n","export default class Events {\n    constructor() {\n        this.destroyEvents = [];\n        this.proxy = this.proxy.bind(this);\n    }\n\n    proxy(target, name, callback, option = {}) {\n        if (Array.isArray(name)) {\n            name.forEach(item => this.proxy(target, item, callback, option));\n        } else {\n            target.addEventListener(name, callback, option);\n            this.destroyEvents.push(() => {\n                target.removeEventListener(name, callback, option);\n            });\n        }\n    }\n\n    destroy() {\n        this.destroyEvents.forEach(event => event());\n    }\n}\n","import DT from 'duration-time-conversion';\n\nexport class WFPlayerError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'WFPlayerError';\n    }\n}\n\nexport function errorHandle(condition, msg) {\n    if (!condition) {\n        throw new WFPlayerError(msg);\n    }\n    return condition;\n}\n\nexport function durationToTime(duration = 0) {\n    return DT.d2t(duration);\n}\n\nexport function timeToDuration(time) {\n    return DT.t2d(time);\n}\n\nexport function mergeBuffer(...buffers) {\n    const Cons = buffers[0].constructor;\n    return buffers.reduce((pre, val) => {\n        const merge = new Cons((pre.byteLength | 0) + (val.byteLength | 0));\n        merge.set(pre, 0);\n        merge.set(val, pre.byteLength | 0);\n        return merge;\n    }, new Cons());\n}\n\nexport function clamp(num, a, b) {\n    return Math.max(Math.min(num, Math.max(a, b)), Math.min(a, b));\n}\n\nexport function setStyle(element, key, value) {\n    if (typeof key === 'object') {\n        Object.keys(key).forEach(item => {\n            setStyle(element, item, key[item]);\n        });\n    }\n    element.style[key] = value;\n    return element;\n}","import { errorHandle } from './utils';\n\nexport default class Template {\n    constructor(wf) {\n        this.wf = wf;\n        this.canvas = null;\n        this.update();\n    }\n\n    update() {\n        const { container, pixelRatio } = this.wf.options;\n        const { clientWidth, clientHeight } = container;\n        if (this.canvas) {\n            this.canvas.width = clientWidth * pixelRatio;\n            this.canvas.height = clientHeight * pixelRatio;\n        } else {\n            errorHandle(\n                this.wf.constructor.instances.every(wf => wf.options.container !== container),\n                'Cannot mount multiple instances on the same dom element, please destroy the previous instance first.',\n            );\n            errorHandle(clientWidth && clientHeight, 'The width and height of the container cannot be 0');\n            container.innerHTML = '';\n            this.canvas = document.createElement('canvas');\n            this.canvas.width = clientWidth * pixelRatio;\n            this.canvas.height = clientHeight * pixelRatio;\n            this.canvas.style.width = '100%';\n            this.canvas.style.height = '100%';\n            container.appendChild(this.canvas);\n        }\n    }\n\n    exportImage() {\n        const elink = document.createElement('a');\n        elink.style.display = 'none';\n        elink.href = this.canvas.toDataURL('image/png');\n        elink.download = `${Date.now()}.png`;\n        document.body.appendChild(elink);\n        elink.click();\n        document.body.removeChild(elink);\n    }\n\n    destroy() {\n        this.wf.options.container.innerHTML = '';\n    }\n}\n","import { durationToTime, clamp } from './utils';\n\nexport default class Drawer {\n    constructor(wf) {\n        this.wf = wf;\n        this.canvas = wf.template.canvas;\n        this.ctx = this.canvas.getContext('2d');\n        this.gridNum = 0;\n        this.gridGap = 0;\n        this.beginTime = 0;\n\n        this.update();\n\n        wf.on('options', () => {\n            this.update();\n        });\n\n        wf.on('channelData', () => {\n            this.update();\n        });\n    }\n\n    update() {\n        const {\n            currentTime,\n            options: { cursor, grid, ruler, wave, duration, padding },\n        } = this.wf;\n        this.gridNum = duration * 10 + padding * 2;\n        this.gridGap = this.canvas.width / this.gridNum;\n        this.beginTime = currentTime - duration / 2;\n\n        this.density =\n            {\n                1: 5,\n                2: 4,\n                3: 3,\n                4: 3,\n                5: 2,\n                6: 2,\n                7: 2,\n                8: 2,\n            }[Math.floor(this.gridGap)] || 1;\n\n        this.wf.emit('render', {\n            padding,\n            duration,\n            gridGap: this.gridGap,\n            gridNum: this.gridNum,\n            beginTime: this.beginTime,\n        });\n\n        this.drawBackground();\n        if (grid) {\n            this.drawGrid();\n        }\n        if (ruler) {\n            this.drawRuler();\n        }\n        if (wave) {\n            this.drawWave();\n        }\n        if (cursor) {\n            this.drawCursor();\n        }\n    }\n\n    drawBackground() {\n        const { backgroundColor, paddingColor, padding } = this.wf.options;\n        const { width, height } = this.canvas;\n        this.ctx.clearRect(0, 0, width, height);\n        this.ctx.fillStyle = backgroundColor;\n        this.ctx.fillRect(0, 0, width, height);\n        this.ctx.fillStyle = paddingColor;\n        this.ctx.fillRect(0, 0, padding * this.gridGap, height);\n        this.ctx.fillRect(width - padding * this.gridGap, 0, padding * this.gridGap, height);\n    }\n\n    drawWave() {\n        const {\n            options: { progress, waveColor, progressColor, duration, padding, waveScale },\n            decoder: {\n                channelData,\n                audiobuffer: { sampleRate },\n            },\n        } = this.wf;\n        if (!channelData.length) return;\n        const { width, height } = this.canvas;\n        const middle = height / 2;\n        const waveWidth = width - this.gridGap * padding * 2;\n        const startIndex = Math.floor(this.beginTime * sampleRate);\n        const endIndex = Math.floor(clamp((this.beginTime + duration) * sampleRate, startIndex, Infinity));\n        const step = Math.floor((endIndex - startIndex) / waveWidth);\n        const cursorX = width / 2;\n\n        let stepIndex = 0;\n        let xIndex = 0;\n        let min = 1;\n        let max = -1;\n        for (let i = startIndex; i < endIndex; i += 1) {\n            stepIndex += 1;\n            const item = channelData[i] || 0;\n            if (item < min) {\n                min = item;\n            } else if (item > max) {\n                max = item;\n            }\n            if (stepIndex >= step && xIndex < waveWidth) {\n                xIndex += 1;\n                const waveX = this.gridGap * padding + xIndex;\n                this.ctx.fillStyle = progress && cursorX >= waveX ? progressColor : waveColor;\n                this.ctx.fillRect(\n                    waveX,\n                    (1 + min * waveScale) * middle,\n                    1,\n                    Math.max(1, (max - min) * middle * waveScale),\n                );\n                stepIndex = 0;\n                min = 1;\n                max = -1;\n            }\n        }\n    }\n\n    drawGrid() {\n        const { currentTime } = this.wf;\n        const { gridColor, pixelRatio } = this.wf.options;\n        const { width, height } = this.canvas;\n        this.ctx.fillStyle = gridColor;\n        for (let index = 0; index < this.gridNum + 10; index += this.density) {\n            this.ctx.fillRect(\n                this.gridGap * index - (currentTime - parseInt(currentTime)) * this.gridGap * 10,\n                0,\n                pixelRatio,\n                height,\n            );\n        }\n        for (let index = 0; index < height / this.gridGap; index += this.density) {\n            this.ctx.fillRect(0, this.gridGap * index, width, pixelRatio);\n        }\n    }\n\n    drawRuler() {\n        const { currentTime } = this.wf;\n        const { rulerColor, pixelRatio, padding, rulerAtTop } = this.wf.options;\n        const { height } = this.canvas;\n        const fontSize = 11;\n        const fontHeight = 15;\n        const fontTop = 30;\n        this.ctx.font = `${fontSize * pixelRatio}px Arial`;\n        this.ctx.fillStyle = rulerColor;\n        let second = -1;\n        for (let index = 0; index < this.gridNum + 10; index += 1) {\n            if (index && index >= padding && index <= this.gridNum + 10 && (index - padding) % 10 === 0) {\n                second += 1;\n                this.ctx.fillRect(\n                    this.gridGap * index - (currentTime - parseInt(currentTime)) * this.gridGap * 10,\n                    rulerAtTop ? 0 : height - fontHeight * pixelRatio,\n                    pixelRatio,\n                    fontHeight * pixelRatio,\n                );\n\n                const time = this.beginTime + second;\n                if ((index - padding) % (this.density * 10) === 0 && time >= 0) {\n                    const text = durationToTime(time).split('.')[0];\n                    const x =\n                        this.gridGap * index -\n                        (currentTime - parseInt(currentTime)) * this.gridGap * 10 -\n                        fontSize * pixelRatio * 2 +\n                        pixelRatio;\n                    const y = rulerAtTop ? fontTop * pixelRatio : height - fontTop * pixelRatio + fontSize;\n                    this.ctx.fillText(text, x, y);\n                }\n            } else if (index && (index - padding) % 5 === 0) {\n                this.ctx.fillRect(\n                    this.gridGap * index - (currentTime - parseInt(currentTime)) * this.gridGap * 10,\n                    rulerAtTop ? 0 : height - (fontHeight / 2) * pixelRatio,\n                    pixelRatio,\n                    (fontHeight / 2) * pixelRatio,\n                );\n            }\n        }\n    }\n\n    drawCursor() {\n        const {\n            options: { cursorColor, pixelRatio },\n        } = this.wf;\n        const { width, height } = this.canvas;\n        this.ctx.fillStyle = cursorColor;\n        this.ctx.fillRect(width / 2, 0, pixelRatio, height);\n    }\n}\n","import throttle from 'lodash/throttle';\n\nexport default class Decoder {\n    constructor(wf) {\n        this.wf = wf;\n        this.audioCtx = new (window.OfflineAudioContext || window.webkitOfflineAudioContext)(1, 2, 44100);\n        this.throttleDecodeAudioData = throttle(this.decodeAudioData, 1000);\n        this.audiobuffer = this.audioCtx.createBuffer(1, 2, 44100);\n        this.channelData = new Float32Array();\n\n        this.wf.on('loading', (uint8) => {\n            this.throttleDecodeAudioData(uint8);\n        });\n    }\n\n    decodeAudioData(uint8) {\n        return new Promise((resolve) => {\n            this.audioCtx.decodeAudioData(\n                uint8.buffer,\n                (audiobuffer) => {\n                    this.decodeSuccess(audiobuffer);\n                    resolve(audiobuffer);\n                },\n                () => resolve(),\n            );\n        });\n    }\n\n    decodeSuccess(audiobuffer) {\n        this.audiobuffer = audiobuffer;\n        this.wf.emit('audiobuffer', this.audiobuffer);\n        this.wf.emit('decodeing', this.audiobuffer.duration / this.wf.duration);\n        this.channelData = audiobuffer.getChannelData(this.wf.options.channel);\n        this.wf.emit('channelData', this.channelData);\n    }\n\n    changeChannel(channel) {\n        this.channelData = this.audiobuffer.getChannelData(channel);\n        this.wf.emit('channelData', this.channelData);\n    }\n\n    destroy() {\n        this.audiobuffer = this.audioCtx.createBuffer(1, 2, 44100);\n        this.channelData = new Float32Array();\n    }\n}\n","import { mergeBuffer } from './utils';\n\nexport default class Loader {\n    constructor(wf) {\n        this.wf = wf;\n        this.fileSize = 0;\n        this.loadSize = 0;\n        this.data = new Uint8Array();\n        this.reader = null;\n        this.abortController = null;\n    }\n\n    load(url) {\n        this.destroy();\n        this.abortController = new AbortController();\n        const { withCredentials, cors, headers } = this.wf.options;\n        this.wf.emit('loadStart');\n        return fetch(url, {\n            credentials: withCredentials ? 'include' : 'omit',\n            mode: cors ? 'cors' : 'no-cors',\n            signal: this.abortController.signal,\n            headers,\n        })\n            .then(response => {\n                if (response.body && typeof response.body.getReader === 'function') {\n                    this.fileSize = Number(response.headers.get('content-length'));\n                    this.wf.emit('fileSize', this.fileSize);\n                    this.reader = response.body.getReader();\n                    return function read() {\n                        return this.reader.read().then(({ done, value }) => {\n                            if (done) {\n                                this.wf.emit('loadEnd');\n                                return null;\n                            }\n                            this.loadSize += value.byteLength;\n                            this.wf.emit('downloading', this.loadSize / this.fileSize);\n                            this.data = mergeBuffer(this.data, value);\n                            this.wf.emit('loading', this.data.slice());\n                            return read.call(this);\n                        });\n                    }.call(this);\n                }\n                return response.arrayBuffer();\n            })\n            .then(arrayBuffer => {\n                if (arrayBuffer && arrayBuffer.byteLength) {\n                    const uint8 = new Uint8Array(arrayBuffer);\n                    this.fileSize = uint8.byteLength;\n                    this.wf.emit('fileSize', this.fileSize);\n                    this.loadSize = uint8.byteLength;\n                    this.wf.emit('downloading', this.loadSize / this.fileSize);\n                    this.wf.emit('loading', uint8);\n                    this.wf.emit('loadEnd');\n                }\n            });\n    }\n\n    destroy() {\n        this.fileSize = 0;\n        this.loadSize = 0;\n        this.data = new Uint8Array();\n        if (this.reader) {\n            this.reader.cancel();\n            this.reader = null;\n        }\n        if (this.abortController) {\n            this.abortController.abort();\n            this.abortController = null;\n        }\n    }\n}\n","import throttle from 'lodash/throttle';\nimport { clamp } from './utils';\n\nexport default class Controller {\n    constructor(wf) {\n        this.wf = wf;\n        this.playTimer = null;\n        this.wf.on('load', () => {\n            this.clickInit();\n            this.resizeInit();\n            this.playInit();\n        });\n    }\n\n    getTimeFromEvent(event) {\n        const {\n            currentTime,\n            template: { canvas },\n            options: { duration, padding, container, pixelRatio },\n        } = this.wf;\n        const gridNum = duration * 10 + padding * 2;\n        const gridGap = canvas.width / gridNum;\n        const left = clamp(event.pageX - container.offsetLeft - (padding * gridGap) / pixelRatio, 0, Infinity);\n        const beginTime = Math.floor(currentTime / duration) * duration;\n        const time = beginTime + clamp(((left / gridGap) * pixelRatio) / 10, 0, duration);\n        return time;\n    }\n\n    clickInit() {\n        const {\n            template: { canvas },\n            events: { proxy },\n            options: { mediaElement },\n        } = this.wf;\n        proxy(canvas, ['click', 'contextmenu'], event => {\n            const time = this.getTimeFromEvent(event);\n            this.wf.emit(event.type, time, event);\n            if (mediaElement && mediaElement.currentTime !== time) {\n                mediaElement.currentTime = time;\n            }\n            this.wf.drawer.update();\n        });\n    }\n\n    resizeInit() {\n        const {\n            template,\n            drawer,\n            events: { proxy },\n        } = this.wf;\n\n        const throttleResize = throttle(() => {\n            template.update();\n            drawer.update();\n            this.wf.emit('resize');\n        }, 500);\n\n        proxy(window, ['resize', 'orientationchange'], () => {\n            throttleResize();\n        });\n    }\n\n    playInit() {\n        const {\n            drawer,\n            events: { proxy },\n            options: { mediaElement },\n        } = this.wf;\n        if (!mediaElement) return;\n\n        proxy(mediaElement, 'seeked', () => {\n            drawer.update();\n        });\n\n        (function loop() {\n            this.playTimer = requestAnimationFrame(() => {\n                if (this.wf.playing) {\n                    drawer.update();\n                    this.wf.emit('playing', mediaElement.currentTime);\n                }\n\n                if (!this.wf.isDestroy) {\n                    loop.call(this);\n                }\n            });\n        }.call(this));\n    }\n\n    destroy() {\n        cancelAnimationFrame(this.playTimer);\n    }\n}\n","import validator from 'option-validator';\nimport Emitter from './emitter';\nimport Events from './events';\nimport Template from './template';\nimport Drawer from './drawer';\nimport Decoder from './decoder';\nimport Loader from './loader';\nimport Controller from './controller';\nimport { timeToDuration, clamp, errorHandle } from './utils';\n\nlet id = 0;\nconst instances = [];\nexport default class WFPlayer extends Emitter {\n    static get instances() {\n        return instances;\n    }\n\n    static get version() {\n        return '__VERSION__';\n    }\n\n    static get env() {\n        return '__ENV__';\n    }\n\n    static get default() {\n        return {\n            container: '#waveform',\n            mediaElement: null,\n            wave: true,\n            waveColor: 'rgba(255, 255, 255, 0.1)',\n            backgroundColor: 'rgb(28, 32, 34)',\n            paddingColor: 'rgba(255, 255, 255, 0.05)',\n            cursor: true,\n            cursorColor: '#ff0000',\n            progress: true,\n            progressColor: 'rgba(255, 255, 255, 0.5)',\n            grid: true,\n            gridColor: 'rgba(255, 255, 255, 0.05)',\n            ruler: true,\n            rulerColor: 'rgba(255, 255, 255, 0.5)',\n            rulerAtTop: true,\n            withCredentials: false,\n            cors: false,\n            headers: {},\n            channel: 0,\n            duration: 10,\n            padding: 5,\n            waveScale: 0.8,\n            pixelRatio: Math.ceil(window.devicePixelRatio),\n        };\n    }\n\n    static get scheme() {\n        const checkNum = (name, min, max, isInteger) => (value, type) => {\n            errorHandle(type === 'number', `${name} expects to receive number as a parameter, but got ${type}.`);\n            errorHandle(\n                value >= min && value <= max && (isInteger ? Number.isInteger(value) : true),\n                `'options.${name}' expect ${\n                    isInteger ? 'an integer ' : 'a '\n                }number that >= ${min} and <= ${max}, but got ${value}.`,\n            );\n            return true;\n        };\n\n        return {\n            container: 'htmlelement|htmldivelement',\n            mediaElement: 'null|htmlvideoelement|htmlaudioelement',\n            wave: 'boolean',\n            waveColor: 'string',\n            backgroundColor: 'string',\n            paddingColor: 'string',\n            cursor: 'boolean',\n            cursorColor: 'string',\n            progress: 'boolean',\n            progressColor: 'string',\n            grid: 'boolean',\n            gridColor: 'string',\n            ruler: 'boolean',\n            rulerColor: 'string',\n            rulerAtTop: 'boolean',\n            withCredentials: 'boolean',\n            cors: 'boolean',\n            headers: 'object',\n            channel: checkNum('channel', 0, 5, true),\n            duration: checkNum('duration', 1, 100, true),\n            padding: checkNum('padding', 1, 100, true),\n            waveScale: checkNum('waveScale', 0.1, 10, false),\n            pixelRatio: checkNum('pixelRatio', 1, 10, false),\n        };\n    }\n\n    constructor(options = {}) {\n        super();\n\n        this._currentTime = 0;\n        this.isDestroy = false;\n        this.options = {};\n        this.setOptions(options);\n\n        this.events = new Events(this);\n        this.template = new Template(this);\n        this.decoder = new Decoder(this);\n        this.drawer = new Drawer(this);\n        this.controller = new Controller(this);\n        this.loader = new Loader(this);\n\n        id += 1;\n        this.id = id;\n        instances.push(this);\n    }\n\n    get currentTime() {\n        return this.options.mediaElement ? this.options.mediaElement.currentTime : this._currentTime;\n    }\n\n    get duration() {\n        return this.options.mediaElement ? this.options.mediaElement.duration : timeToDuration('99:59:59.999');\n    }\n\n    get hasChannelData() {\n        return !!this.decoder.channelData.byteLength;\n    }\n\n    get playing() {\n        const { mediaElement } = this.options;\n        if (mediaElement) {\n            return !!(\n                mediaElement.currentTime > 0 &&\n                !mediaElement.paused &&\n                !mediaElement.ended &&\n                mediaElement.readyState > 2\n            );\n        }\n        return false;\n    }\n\n    setOptions(options = {}) {\n        errorHandle(validator.kindOf(options) === 'object', 'setOptions expects to receive object as a parameter.');\n\n        if (typeof options.container === 'string') {\n            options.container = document.querySelector(options.container);\n        }\n\n        if (typeof options.mediaElement === 'string') {\n            options.mediaElement = document.querySelector(options.mediaElement);\n        }\n\n        this.options = validator(\n            {\n                ...WFPlayer.default,\n                ...this.options,\n                ...options,\n            },\n            WFPlayer.scheme,\n        );\n\n        this.emit('options', this.options);\n        return this;\n    }\n\n    load(target) {\n        if (target && typeof target.getChannelData === 'function') {\n            this.decoder.decodeSuccess(target);\n            this.emit('load');\n            return this;\n        }\n        if (target instanceof HTMLVideoElement || target instanceof HTMLAudioElement) {\n            this.options.mediaElement = target;\n            target = target.src;\n        }\n        errorHandle(\n            typeof target === 'string' && target.trim(),\n            `The load target is not a string. If you are loading a mediaElement, make sure the mediaElement.src is not empty.`,\n        );\n        this.loader.load(target);\n        this.emit('load');\n        return this;\n    }\n\n    seek(second) {\n        errorHandle(typeof second === 'number', 'seek expects to receive number as a parameter.');\n        this._currentTime = clamp(second, 0, this.duration);\n        if (this.options.mediaElement && this.options.mediaElement.currentTime !== this._currentTime) {\n            this.options.mediaElement.currentTime = this._currentTime;\n        }\n        this.drawer.update();\n        return this;\n    }\n\n    changeChannel(channel) {\n        this.setOptions({ channel });\n        this.decoder.changeChannel(channel);\n    }\n\n    exportImage() {\n        this.template.exportImage();\n        return this;\n    }\n\n    destroy() {\n        this.isDestroy = true;\n        this.events.destroy();\n        this.template.destroy();\n        this.controller.destroy();\n        this.decoder.destroy();\n        this.loader.destroy();\n        instances.splice(instances.indexOf(this), 1);\n    }\n}\n","import { ContextMenu, MenuItem, ContextMenuTrigger } from 'react-contextmenu';\nimport React, { useEffect, useCallback } from 'react';\nimport { Translate } from 'react-i18nify';\nimport styled from 'styled-components';\nimport isEqual from 'lodash/isEqual';\nimport DT from 'duration-time-conversion';\nimport { getKeyCode } from '../utils';\n\nconst Timeline = styled.div`\n    position: absolute;\n    z-index: 9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n\n    .react-contextmenu-wrapper {\n        position: absolute;\n        z-index: 9;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: all;\n    }\n\n    .sub-item {\n        position: absolute;\n        top: 30%;\n        left: 0;\n        height: 40%;\n        overflow: hidden;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        text-align: center;\n        color: #fff;\n        font-size: 14px;\n        cursor: move;\n        user-select: none;\n        pointer-events: all;\n        background-color: rgba(255, 255, 255, 0.2);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n\n        &:hover {\n            background-color: rgba(255, 255, 255, 0.3);\n        }\n\n        &.sub-highlight {\n            background-color: rgba(33, 150, 243, 0.5);\n            border: 1px solid rgba(33, 150, 243, 0.5);\n        }\n\n        &.sub-illegal {\n            background-color: rgba(199, 81, 35, 0.5);\n        }\n\n        .sub-handle {\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            z-index: 1;\n            height: 100%;\n            cursor: col-resize;\n            user-select: none;\n            &:hover {\n                background-color: rgba(255, 255, 255, 0.1);\n            }\n        }\n\n        .sub-text {\n            position: relative;\n            z-index: 0;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex-direction: column;\n            word-break: break-all;\n            white-space: nowrap;\n            text-shadow: rgb(0 0 0) 1px 0px 1px, rgb(0 0 0) 0px 1px 1px, rgb(0 0 0) -1px 0px 1px,\n                rgb(0 0 0) 0px -1px 1px;\n            width: 100%;\n            height: 100%;\n\n            p {\n                margin: 2px 0;\n                line-height: 1;\n\n                &.bilingual {\n                    transform: scale(0.8);\n                }\n            }\n        }\n\n        .sub-duration {\n            opacity: 0.5;\n            position: absolute;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            width: 100%;\n            text-align: center;\n            font-size: 12px;\n        }\n    }\n`;\n\nfunction getCurrentSubs(subs, beginTime, duration) {\n    return subs.filter((item) => {\n        return (\n            (item.startTime >= beginTime && item.startTime <= beginTime + duration) ||\n            (item.endTime >= beginTime && item.endTime <= beginTime + duration) ||\n            (item.startTime < beginTime && item.endTime > beginTime + duration)\n        );\n    });\n}\n\nfunction magnetically(time, closeTime) {\n    if (!closeTime) return time;\n    if (time > closeTime - 0.1 && closeTime + 0.1 > time) {\n        return closeTime;\n    }\n    return time;\n}\n\nlet lastTarget = null;\nlet lastSub = null;\nlet lastType = '';\nlet lastX = 0;\nlet lastIndex = -1;\nlet lastWidth = 0;\nlet lastDiffX = 0;\nlet isDroging = false;\n\nexport default React.memo(\n    function ({ player, subtitle, render, currentTime, checkSub, removeSub, hasSub, updateSub, mergeSub }) {\n        const $blockRef = React.createRef();\n        const $subsRef = React.createRef();\n        const currentSubs = getCurrentSubs(subtitle, render.beginTime, render.duration);\n        const gridGap = document.body.clientWidth / render.gridNum;\n        const currentIndex = currentSubs.findIndex(\n            (item) => item.startTime <= currentTime && item.endTime > currentTime,\n        );\n\n        const onMouseDown = (sub, event, type) => {\n            lastSub = sub;\n            if (event.button !== 0) return;\n            isDroging = true;\n            lastType = type;\n            lastX = event.pageX;\n            lastIndex = currentSubs.indexOf(sub);\n            lastTarget = $subsRef.current.children[lastIndex];\n            lastWidth = parseFloat(lastTarget.style.width);\n        };\n\n        const onDoubleClick = (sub, event) => {\n            const $subs = event.currentTarget;\n            const index = hasSub(sub);\n            const previou = subtitle[index - 1];\n            const next = subtitle[index + 1];\n            if (previou && next) {\n                const width = (next.startTime - previou.endTime) * 10 * gridGap;\n                $subs.style.width = `${width}px`;\n                const start = DT.d2t(previou.endTime);\n                const end = DT.d2t(next.startTime);\n                updateSub(sub, {\n                    start,\n                    end,\n                });\n            }\n        };\n\n        const onDocumentMouseMove = useCallback((event) => {\n            if (isDroging && lastTarget) {\n                lastDiffX = event.pageX - lastX;\n                if (lastType === 'left') {\n                    lastTarget.style.width = `${lastWidth - lastDiffX}px`;\n                    lastTarget.style.transform = `translate(${lastDiffX}px)`;\n                } else if (lastType === 'right') {\n                    lastTarget.style.width = `${lastWidth + lastDiffX}px`;\n                } else {\n                    lastTarget.style.transform = `translate(${lastDiffX}px)`;\n                }\n            }\n        }, []);\n\n        const onDocumentMouseUp = useCallback(() => {\n            if (isDroging && lastTarget && lastDiffX) {\n                const timeDiff = lastDiffX / gridGap / 10;\n                const index = hasSub(lastSub);\n                const previou = subtitle[index - 1];\n                const next = subtitle[index + 1];\n\n                const startTime = magnetically(lastSub.startTime + timeDiff, previou ? previou.endTime : null);\n                const endTime = magnetically(lastSub.endTime + timeDiff, next ? next.startTime : null);\n                const width = (endTime - startTime) * 10 * gridGap;\n\n                if ((previou && endTime < previou.startTime) || (next && startTime > next.endTime)) {\n                    //\n                } else {\n                    if (lastType === 'left') {\n                        if (startTime >= 0 && lastSub.endTime - startTime >= 0.2) {\n                            const start = DT.d2t(startTime);\n                            updateSub(lastSub, { start });\n                        } else {\n                            lastTarget.style.width = `${width}px`;\n                        }\n                    } else if (lastType === 'right') {\n                        if (endTime >= 0 && endTime - lastSub.startTime >= 0.2) {\n                            const end = DT.d2t(endTime);\n                            updateSub(lastSub, { end });\n                        } else {\n                            lastTarget.style.width = `${width}px`;\n                        }\n                    } else {\n                        if (startTime > 0 && endTime > 0 && endTime - startTime >= 0.2) {\n                            const start = DT.d2t(startTime);\n                            const end = DT.d2t(endTime);\n                            updateSub(lastSub, {\n                                start,\n                                end,\n                            });\n                        } else {\n                            lastTarget.style.width = `${width}px`;\n                        }\n                    }\n                }\n\n                lastTarget.style.transform = `translate(0)`;\n            }\n\n            lastType = '';\n            lastX = 0;\n            lastWidth = 0;\n            lastDiffX = 0;\n            isDroging = false;\n        }, [gridGap, hasSub, subtitle, updateSub]);\n\n        const onKeyDown = useCallback(\n            (event) => {\n                const sub = currentSubs[lastIndex];\n                if (sub && lastTarget) {\n                    const keyCode = getKeyCode(event);\n                    switch (keyCode) {\n                        case 37:\n                            updateSub(sub, {\n                                start: DT.d2t(sub.startTime - 0.1),\n                                end: DT.d2t(sub.endTime - 0.1),\n                            });\n                            player.currentTime = sub.startTime - 0.1;\n                            break;\n                        case 39:\n                            updateSub(sub, {\n                                start: DT.d2t(sub.startTime + 0.1),\n                                end: DT.d2t(sub.endTime + 0.1),\n                            });\n                            player.currentTime = sub.startTime + 0.1;\n                            break;\n                        case 8:\n                        case 46:\n                            removeSub(sub);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            },\n            [currentSubs, player, removeSub, updateSub],\n        );\n\n        useEffect(() => {\n            document.addEventListener('mousemove', onDocumentMouseMove);\n            document.addEventListener('mouseup', onDocumentMouseUp);\n            window.addEventListener('keydown', onKeyDown);\n            return () => {\n                document.removeEventListener('mousemove', onDocumentMouseMove);\n                document.removeEventListener('mouseup', onDocumentMouseUp);\n                window.removeEventListener('keydown', onKeyDown);\n            };\n        }, [onDocumentMouseMove, onDocumentMouseUp, onKeyDown]);\n\n        return (\n            <Timeline ref={$blockRef}>\n                <div ref={$subsRef}>\n                    {currentSubs.map((sub, key) => {\n                        return (\n                            <div\n                                className={[\n                                    'sub-item',\n                                    key === currentIndex ? 'sub-highlight' : '',\n                                    checkSub(sub) ? 'sub-illegal' : '',\n                                ]\n                                    .join(' ')\n                                    .trim()}\n                                key={key}\n                                style={{\n                                    left: render.padding * gridGap + (sub.startTime - render.beginTime) * gridGap * 10,\n                                    width: (sub.endTime - sub.startTime) * gridGap * 10,\n                                }}\n                                onClick={() => {\n                                    if (player.duration >= sub.startTime) {\n                                        player.currentTime = sub.startTime + 0.001;\n                                    }\n                                }}\n                                onDoubleClick={(event) => onDoubleClick(sub, event)}\n                            >\n                                <ContextMenuTrigger id=\"contextmenu\" holdToDisplay={-1}>\n                                    <div\n                                        className=\"sub-handle\"\n                                        style={{\n                                            left: 0,\n                                            width: 10,\n                                        }}\n                                        onMouseDown={(event) => onMouseDown(sub, event, 'left')}\n                                    ></div>\n\n                                    <div\n                                        className=\"sub-text\"\n                                        title={sub.text}\n                                        onMouseDown={(event) => onMouseDown(sub, event)}\n                                    >\n                                        {`${sub.text}`.split(/\\r?\\n/).map((line, index) => (\n                                            <p key={index}>{line}</p>\n                                        ))}\n                                    </div>\n\n                                    <div\n                                        className=\"sub-handle\"\n                                        style={{\n                                            right: 0,\n                                            width: 10,\n                                        }}\n                                        onMouseDown={(event) => onMouseDown(sub, event, 'right')}\n                                    ></div>\n                                    <div className=\"sub-duration\">{sub.duration}</div>\n                                </ContextMenuTrigger>\n                            </div>\n                        );\n                    })}\n                </div>\n                <ContextMenu id=\"contextmenu\">\n                    <MenuItem onClick={() => removeSub(lastSub)}>\n                        <Translate value=\"DELETE\" />\n                    </MenuItem>\n                    <MenuItem onClick={() => mergeSub(lastSub)}>\n                        <Translate value=\"MERGE\" />\n                    </MenuItem>\n                </ContextMenu>\n            </Timeline>\n        );\n    },\n    (prevProps, nextProps) => {\n        return (\n            isEqual(prevProps.subtitle, nextProps.subtitle) &&\n            isEqual(prevProps.render, nextProps.render) &&\n            prevProps.currentTime === nextProps.currentTime\n        );\n    },\n);\n","import React, { useEffect, useCallback, useState } from 'react';\nimport styled from 'styled-components';\nimport DT from 'duration-time-conversion';\nimport { t } from 'react-i18nify';\n\nconst Metronome = styled.div`\n    position: absolute;\n    z-index: 8;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    cursor: ew-resize;\n    user-select: none;\n\n    .template {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        height: 100%;\n        background-color: rgba(76, 175, 80, 0.5);\n        border-left: 1px solid rgba(76, 175, 80, 0.8);\n        border-right: 1px solid rgba(76, 175, 80, 0.8);\n        user-select: none;\n        pointer-events: none;\n    }\n`;\n\nfunction findIndex(subs, startTime) {\n    return subs.findIndex((item, index) => {\n        return (\n            (startTime >= item.endTime && !subs[index + 1]) ||\n            (item.startTime <= startTime && item.endTime > startTime) ||\n            (startTime >= item.endTime && subs[index + 1] && startTime < subs[index + 1].startTime)\n        );\n    });\n}\n\nexport default function Component({ render, subtitle, newSub, addSub, player, playing }) {\n    const [isDroging, setIsDroging] = useState(false);\n    const [drogStartTime, setDrogStartTime] = useState(0);\n    const [drogEndTime, setDrogEndTime] = useState(0);\n    const gridGap = document.body.clientWidth / render.gridNum;\n\n    const getEventTime = useCallback(\n        (event) => {\n            return (event.pageX - render.padding * gridGap) / gridGap / 10 + render.beginTime;\n        },\n        [gridGap, render],\n    );\n\n    const onMouseDown = useCallback(\n        (event) => {\n            if (event.button !== 0) return;\n            const clickTime = getEventTime(event);\n            setIsDroging(true);\n            setDrogStartTime(clickTime);\n        },\n        [getEventTime],\n    );\n\n    const onMouseMove = useCallback(\n        (event) => {\n            if (isDroging) {\n                if (playing) player.pause();\n                setDrogEndTime(getEventTime(event));\n            }\n        },\n        [isDroging, playing, player, getEventTime],\n    );\n\n    const onDocumentMouseUp = useCallback(() => {\n        if (isDroging) {\n            if (drogStartTime > 0 && drogEndTime > 0 && drogEndTime - drogStartTime >= 0.2) {\n                const index = findIndex(subtitle, drogStartTime) + 1;\n                const start = DT.d2t(drogStartTime);\n                const end = DT.d2t(drogEndTime);\n                addSub(\n                    index,\n                    newSub({\n                        start,\n                        end,\n                        text: t('SUB_TEXT'),\n                    }),\n                );\n            }\n        }\n        setIsDroging(false);\n        setDrogStartTime(0);\n        setDrogEndTime(0);\n    }, [isDroging, drogStartTime, drogEndTime, subtitle, addSub, newSub]);\n\n    useEffect(() => {\n        document.addEventListener('mouseup', onDocumentMouseUp);\n        return () => document.removeEventListener('mouseup', onDocumentMouseUp);\n    }, [onDocumentMouseUp]);\n\n    return (\n        <Metronome onMouseDown={onMouseDown} onMouseMove={onMouseMove}>\n            {player && !playing && drogStartTime && drogEndTime && drogEndTime > drogStartTime ? (\n                <div\n                    className=\"template\"\n                    style={{\n                        left: render.padding * gridGap + (drogStartTime - render.beginTime) * gridGap * 10,\n                        width: (drogEndTime - drogStartTime) * gridGap * 10,\n                    }}\n                ></div>\n            ) : null}\n        </Metronome>\n    );\n}\n","import styled from 'styled-components';\nimport DT from 'duration-time-conversion';\nimport React, { useState, useEffect, useCallback, createRef, memo } from 'react';\nimport WFPlayer from '../libs/WFPlayer';\nimport clamp from 'lodash/clamp';\nimport throttle from 'lodash/throttle';\nimport Timeline from './Timeline';\nimport Metronome from './Metronome';\n\nconst Style = styled.div`\n    position: relative;\n    display: flex;\n    flex-direction: column;\n\n    .progress {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: -12px;\n        z-index: 11;\n        width: 100%;\n        height: 12px;\n        user-select: none;\n        border-top: 1px solid rgb(255 255 255 / 20%);\n        background-color: rgb(0 0 0 / 50%);\n\n        .bar {\n            position: absolute;\n            left: 0;\n            top: 0;\n            bottom: 0;\n            width: 0%;\n            height: 100%;\n            display: inline-block;\n            background-color: #730000;\n            overflow: hidden;\n\n            .handle {\n                position: absolute;\n                right: 0;\n                top: 0;\n                bottom: 0;\n                width: 10px;\n                cursor: ew-resize;\n                background-color: #ff9800;\n            }\n        }\n\n        .subtitle {\n            position: absolute;\n            left: 0;\n            top: 0;\n            bottom: 0;\n            right: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n\n            span {\n                position: absolute;\n                top: 0;\n                bottom: 0;\n                height: 100%;\n                background-color: rgb(255 255 255 / 20%);\n            }\n        }\n    }\n\n    .duration {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: -40px;\n        z-index: 12;\n        width: 100%;\n        font-size: 18px;\n        color: rgb(255 255 255 / 75%);\n        text-shadow: 0 1px 2px rgb(0 0 0 / 75%);\n        text-align: center;\n        user-select: none;\n        pointer-events: none;\n    }\n\n    .waveform {\n        position: absolute;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        z-index: 1;\n        width: 100%;\n        height: 100%;\n        z-index: 1;\n        user-select: none;\n        pointer-events: none;\n    }\n\n    .grab {\n        position: relative;\n        z-index: 11;\n        cursor: grab;\n        height: 20%;\n        user-select: none;\n        background-color: rgb(33 150 243 / 20%);\n        border-top: 1px solid rgb(33 150 243 / 30%);\n        border-bottom: 1px solid rgb(33 150 243 / 30%);\n\n        &.grabbing {\n            cursor: grabbing;\n        }\n    }\n`;\n\nconst Waveform = memo(\n    ({ player, setWaveform, setRender }) => {\n        const $waveform = createRef();\n\n        useEffect(() => {\n            [...WFPlayer.instances].forEach((item) => item.destroy());\n\n            const waveform = new WFPlayer({\n                duration: 10,\n                padding: 1,\n                wave: true,\n                pixelRatio: 2,\n                container: $waveform.current,\n                mediaElement: player,\n                backgroundColor: 'rgba(0, 0, 0, 0)',\n                waveColor: 'rgba(255, 255, 255, 0.2)',\n                progressColor: 'rgba(255, 255, 255, 0.5)',\n                gridColor: 'rgba(255, 255, 255, 0.05)',\n                rulerColor: 'rgba(255, 255, 255, 0.5)',\n                paddingColor: 'rgba(0, 0, 0, 0)',\n            });\n\n            setWaveform(waveform);\n            waveform.on('render', setRender);\n\n            waveform.load({\n                sampleRate: 44100,\n                getChannelData() {\n                    return new Float32Array();\n                },\n            });\n\n            waveform.load('/sample.mp3');\n        }, [player, $waveform, setWaveform, setRender]);\n\n        return <div className=\"waveform\" ref={$waveform} />;\n    },\n    () => true,\n);\n\nconst Grab = (props) => {\n    const [grabStartX, setGrabStartX] = useState(0);\n    const [grabStartTime, setGrabStartTime] = useState(0);\n    const [grabbing, setGrabbing] = useState(false);\n\n    const onGrabDown = useCallback(\n        (event) => {\n            if (event.button !== 0) return;\n            setGrabStartX(event.pageX);\n            setGrabStartTime(props.player.currentTime);\n            setGrabbing(true);\n        },\n        [props.player],\n    );\n\n    const onGrabUp = () => {\n        setGrabStartX(0);\n        setGrabStartTime(0);\n        setGrabbing(false);\n    };\n\n    const onGrabMove = useCallback(\n        (event) => {\n            if (grabbing && props.player && props.waveform) {\n                const currentTime = clamp(\n                    grabStartTime - ((event.pageX - grabStartX) / document.body.clientWidth) * 10,\n                    0,\n                    props.player.duration,\n                );\n                props.player.currentTime = currentTime;\n                props.waveform.seek(currentTime);\n            }\n        },\n        [grabbing, props.player, props.waveform, grabStartX, grabStartTime],\n    );\n\n    useEffect(() => {\n        document.addEventListener('mouseup', onGrabUp);\n        return () => document.removeEventListener('mouseup', onGrabUp);\n    }, []);\n\n    return (\n        <div className={`grab ${grabbing ? 'grabbing' : ''}`} onMouseDown={onGrabDown} onMouseMove={onGrabMove}></div>\n    );\n};\n\nconst Progress = (props) => {\n    const [grabbing, setGrabbing] = useState(false);\n\n    const onProgressClick = useCallback(\n        (event) => {\n            if (event.button !== 0) return;\n            const currentTime = (event.pageX / document.body.clientWidth) * props.player.duration;\n            props.player.currentTime = currentTime;\n            props.waveform.seek(currentTime);\n        },\n        [props],\n    );\n\n    const onGrabDown = useCallback(\n        (event) => {\n            if (event.button !== 0) return;\n            setGrabbing(true);\n        },\n        [setGrabbing],\n    );\n\n    const onGrabMove = useCallback(\n        (event) => {\n            if (grabbing) {\n                const currentTime = (event.pageX / document.body.clientWidth) * props.player.duration;\n                props.player.currentTime = currentTime;\n            }\n        },\n        [grabbing, props.player],\n    );\n\n    const onDocumentMouseUp = useCallback(() => {\n        if (grabbing) {\n            setGrabbing(false);\n            props.waveform.seek(props.player.currentTime);\n        }\n    }, [grabbing, props.waveform, props.player.currentTime]);\n\n    useEffect(() => {\n        document.addEventListener('mouseup', onDocumentMouseUp);\n        document.addEventListener('mousemove', onGrabMove);\n        return () => {\n            document.removeEventListener('mouseup', onDocumentMouseUp);\n            document.removeEventListener('mousemove', onGrabMove);\n        };\n    }, [onDocumentMouseUp, onGrabMove]);\n\n    return (\n        <div className=\"progress\" onClick={onProgressClick}>\n            <div className=\"bar\" style={{ width: `${(props.currentTime / props.player.duration) * 100}%` }}>\n                <div className=\"handle\" onMouseDown={onGrabDown}></div>\n            </div>\n            <div className=\"subtitle\">\n                {props.subtitle.map((item, index) => {\n                    const { duration } = props.player;\n                    return (\n                        <span\n                            key={index}\n                            className=\"item\"\n                            style={{\n                                left: `${(item.startTime / duration) * 100}%`,\n                                width: `${(item.duration / duration) * 100}%`,\n                            }}\n                        ></span>\n                    );\n                })}\n            </div>\n        </div>\n    );\n};\n\nconst Duration = (props) => {\n    const getDuration = useCallback((time) => {\n        time = time === Infinity ? 0 : time;\n        return DT.d2t(time).split('.')[0];\n    }, []);\n\n    return (\n        <div className=\"duration\">\n            <span>\n                {getDuration(props.currentTime)} / {getDuration(props.player.duration || 0)}\n            </span>\n        </div>\n    );\n};\n\nexport default function Footer(props) {\n    const $footer = createRef();\n    const [render, setRender] = useState({\n        padding: 2,\n        duration: 10,\n        gridGap: 10,\n        gridNum: 110,\n        beginTime: -5,\n    });\n\n    const onWheel = useCallback(\n        (event) => {\n            if (\n                !props.player ||\n                !props.waveform ||\n                props.player.playing ||\n                !$footer.current ||\n                !$footer.current.contains(event.target)\n            ) {\n                return;\n            }\n\n            const deltaY = Math.sign(event.deltaY) / 5;\n            const currentTime = clamp(props.player.currentTime + deltaY, 0, props.player.duration);\n            props.player.currentTime = currentTime;\n            props.waveform.seek(currentTime);\n        },\n        [props.waveform, props.player, $footer],\n    );\n\n    useEffect(() => {\n        const onWheelThrottle = throttle(onWheel, 100);\n        window.addEventListener('wheel', onWheelThrottle);\n        return () => window.removeEventListener('wheel', onWheelThrottle);\n    }, [onWheel]);\n\n    return (\n        <Style className=\"footer\" ref={$footer}>\n            {props.player ? (\n                <React.Fragment>\n                    <Progress {...props} />\n                    <Duration {...props} />\n                    <Waveform {...props} setRender={setRender} />\n                    <Grab {...props} render={render} />\n                    <Metronome {...props} render={render} />\n                    <Timeline {...props} render={render} />\n                </React.Fragment>\n            ) : null}\n        </Style>\n    );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { t } from 'react-i18nify';\n\nconst Loading = styled.div`\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    z-index: 99;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    -webkit-backdrop-filter: saturate(180%) blur(2px);\n    backdrop-filter: saturate(180%) blur(2px);\n    background-color: rgba(0, 0, 0, 0.5);\n\n    .loading-inner {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        flex-direction: column;\n        width: 200px;\n        height: 200px;\n        border-radius: 10px;\n        color: #fff;\n        background-color: rgb(34 36 60 / 95%);\n        box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.5);\n\n        img {\n            zoom: 0.5;\n            margin-bottom: 10px;\n        }\n    }\n`;\n\nexport default function Component({ loading }) {\n    return (\n        <Loading>\n            <div className=\"loading-inner\">\n                <img src=\"/loading.svg\" alt=\"loading\" />\n                <div>{loading || t('LOADING')}</div>\n            </div>\n        </Loading>\n    );\n}\n","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport NotificationSystem from 'react-notification-system';\nimport DT from 'duration-time-conversion';\nimport isEqual from 'lodash/isEqual';\nimport styled from 'styled-components';\nimport Tool from './components/Tool';\nimport Subtitles from './components/Subtitles';\nimport Player from './components/Player';\nimport Footer from './components/Footer';\nimport Loading from './components/Loading';\nimport { getKeyCode } from './utils';\nimport Sub from './libs/Sub';\n\nconst Style = styled.div`\n    height: 100%;\n    width: 100%;\n\n    .main {\n        display: flex;\n        height: calc(100% - 200px);\n\n        .player {\n            flex: 1;\n        }\n\n        .subtitles {\n            width: 250px;\n        }\n\n        .tool {\n            width: 300px;\n        }\n    }\n\n    .footer {\n        height: 200px;\n    }\n`;\n\nexport default function App({ defaultLang }) {\n    const subtitleHistory = useRef([]);\n    const notificationSystem = useRef(null);\n    const [player, setPlayer] = useState(null);\n    const [loading, setLoading] = useState('');\n    const [language, setLanguage] = useState(defaultLang);\n    const [subtitle, setSubtitleOriginal] = useState([]);\n    const [waveform, setWaveform] = useState(null);\n    const [playing, setPlaying] = useState(false);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [currentIndex, setCurrentIndex] = useState(-1);\n\n    const newSub = useCallback((item) => new Sub(item), []);\n    const hasSub = useCallback((sub) => subtitle.indexOf(sub), [subtitle]);\n\n    const formatSub = useCallback(\n        (sub) => {\n            if (Array.isArray(sub)) {\n                return sub.map((item) => newSub(item));\n            }\n            return newSub(sub);\n        },\n        [newSub],\n    );\n\n    const copySubs = useCallback(() => formatSub(subtitle), [subtitle, formatSub]);\n\n    const setSubtitle = useCallback(\n        (newSubtitle, saveToHistory = true) => {\n            if (!isEqual(newSubtitle, subtitle)) {\n                if (saveToHistory) {\n                    if (subtitleHistory.current.length >= 1000) {\n                        subtitleHistory.current.shift();\n                    }\n                    subtitleHistory.current.push(formatSub(subtitle));\n                }\n                window.localStorage.setItem('subtitle', JSON.stringify(newSubtitle));\n                setSubtitleOriginal(newSubtitle);\n            }\n        },\n        [subtitle, setSubtitleOriginal, formatSub],\n    );\n\n    const undoSubs = useCallback(() => {\n        const subs = subtitleHistory.current.pop();\n        if (subs) {\n            setSubtitle(subs, false);\n        }\n    }, [setSubtitle, subtitleHistory]);\n\n    const clearSubs = useCallback(() => {\n        setSubtitle([]);\n        subtitleHistory.current.length = 0;\n    }, [setSubtitle, subtitleHistory]);\n\n    const checkSub = useCallback(\n        (sub) => {\n            const index = hasSub(sub);\n            if (index < 0) return;\n            const previous = subtitle[index - 1];\n            return (previous && sub.startTime < previous.endTime) || !sub.check || sub.duration < 0.2;\n        },\n        [subtitle, hasSub],\n    );\n\n    const notify = useCallback(\n        (obj) => {\n            // https://github.com/igorprado/react-notification-system\n            const notification = notificationSystem.current;\n            notification.clearNotifications();\n            notification.addNotification({\n                position: 'tc',\n                dismissible: 'none',\n                autoDismiss: 2,\n                message: obj.message,\n                level: obj.level,\n            });\n        },\n        [notificationSystem],\n    );\n\n    const removeSub = useCallback(\n        (sub) => {\n            const index = hasSub(sub);\n            if (index < 0) return;\n            const subs = copySubs();\n            subs.splice(index, 1);\n            setSubtitle(subs);\n        },\n        [hasSub, copySubs, setSubtitle],\n    );\n\n    const addSub = useCallback(\n        (index, sub) => {\n            const subs = copySubs();\n            subs.splice(index, 0, formatSub(sub));\n            setSubtitle(subs);\n        },\n        [copySubs, setSubtitle, formatSub],\n    );\n\n    const updateSub = useCallback(\n        (sub, obj) => {\n            const index = hasSub(sub);\n            if (index < 0) return;\n            const subs = copySubs();\n            const subClone = formatSub(sub);\n            Object.assign(subClone, obj);\n            if (subClone.check) {\n                subs[index] = subClone;\n                setSubtitle(subs);\n            }\n        },\n        [hasSub, copySubs, setSubtitle, formatSub],\n    );\n\n    const mergeSub = useCallback(\n        (sub) => {\n            const index = hasSub(sub);\n            if (index < 0) return;\n            const subs = copySubs();\n            const next = subs[index + 1];\n            if (!next) return;\n            const merge = newSub({\n                start: sub.start,\n                end: next.end,\n                text: sub.text.trim() + '\\n' + next.text.trim(),\n            });\n            subs[index] = merge;\n            subs.splice(index + 1, 1);\n            setSubtitle(subs);\n        },\n        [hasSub, copySubs, setSubtitle, newSub],\n    );\n\n    const splitSub = useCallback(\n        (sub, start) => {\n            const index = hasSub(sub);\n            if (index < 0 || !sub.text || !start) return;\n            const subs = copySubs();\n            const text1 = sub.text.slice(0, start).trim();\n            const text2 = sub.text.slice(start).trim();\n            if (!text1 || !text2) return;\n            const splitDuration = (sub.duration * (start / sub.text.length)).toFixed(3);\n            if (splitDuration < 0.2 || sub.duration - splitDuration < 0.2) return;\n            subs.splice(index, 1);\n            const middleTime = DT.d2t(sub.startTime + parseFloat(splitDuration));\n            subs.splice(\n                index,\n                0,\n                newSub({\n                    start: sub.start,\n                    end: middleTime,\n                    text: text1,\n                }),\n            );\n            subs.splice(\n                index + 1,\n                0,\n                newSub({\n                    start: middleTime,\n                    end: sub.end,\n                    text: text2,\n                }),\n            );\n            setSubtitle(subs);\n        },\n        [hasSub, copySubs, setSubtitle, newSub],\n    );\n\n    const onKeyDown = useCallback(\n        (event) => {\n            const keyCode = getKeyCode(event);\n            switch (keyCode) {\n                case 32:\n                    event.preventDefault();\n                    if (player) {\n                        if (playing) {\n                            player.pause();\n                        } else {\n                            player.play();\n                        }\n                    }\n                    break;\n                case 90:\n                    event.preventDefault();\n                    if (event.metaKey) {\n                        undoSubs();\n                    }\n                    break;\n                default:\n                    break;\n            }\n        },\n        [player, playing, undoSubs],\n    );\n\n    useEffect(() => {\n        window.addEventListener('keydown', onKeyDown);\n        return () => window.removeEventListener('keydown', onKeyDown);\n    }, [onKeyDown]);\n\n    useMemo(() => {\n        const currentIndex = subtitle.findIndex((item) => item.startTime <= currentTime && item.endTime > currentTime);\n        setCurrentIndex(currentIndex);\n    }, [currentTime, subtitle]);\n\n    useEffect(() => {\n        const localSubtitleString = window.localStorage.getItem('subtitle');\n        const fetchSubtitle = () =>\n            fetch('/sample.json')\n                .then((res) => res.json())\n                .then((res) => {\n                    setSubtitleOriginal(res.map((item) => new Sub(item)));\n                });\n\n        if (localSubtitleString) {\n            try {\n                const localSubtitle = JSON.parse(localSubtitleString);\n                if (localSubtitle.length) {\n                    setSubtitleOriginal(localSubtitle.map((item) => new Sub(item)));\n                } else {\n                    fetchSubtitle();\n                }\n            } catch (error) {\n                fetchSubtitle();\n            }\n        } else {\n            fetchSubtitle();\n        }\n    }, [setSubtitleOriginal]);\n\n    const props = {\n        player,\n        setPlayer,\n        subtitle,\n        setSubtitle,\n        waveform,\n        setWaveform,\n        currentTime,\n        setCurrentTime,\n        currentIndex,\n        setCurrentIndex,\n        playing,\n        setPlaying,\n        language,\n        setLanguage,\n        loading,\n        setLoading,\n        subtitleHistory,\n\n        notify,\n        newSub,\n        hasSub,\n        checkSub,\n        removeSub,\n        addSub,\n        undoSubs,\n        clearSubs,\n        updateSub,\n        formatSub,\n        mergeSub,\n        splitSub,\n    };\n\n    return (\n        <Style>\n            <div className=\"main\">\n                <Player {...props} />\n                <Subtitles {...props} />\n                <Tool {...props} />\n            </div>\n            <Footer {...props} />\n            {loading ? <Loading loading={loading} /> : null}\n            <NotificationSystem ref={notificationSystem} allowHTML={true} />\n        </Style>\n    );\n}\n","import styled from 'styled-components';\nimport { Translate } from 'react-i18nify';\n\nconst Style = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    width: 100%;\n`;\n\nexport default function Mobile() {\n    return (\n        <Style>\n            <Translate value=\"MOBILE_TIP\" />\n        </Style>\n    );\n}\n","import { createGlobalStyle } from 'styled-components';\n\nexport default createGlobalStyle`\n    html,\n    body,\n    #root {\n        height: 100%;\n    }\n\n    body {\n        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;\n        line-height: 1.5;\n        overflow: hidden;\n    }\n\n    *, *::before, *::after {\n        box-sizing: border-box;\n    }\n\n    #root {\n        display: flex;\n        font-size: 14px;\n        color: #ccc;\n        background-color: rgb(0 0 0 / 90%);\n    }\n\n    ::-webkit-scrollbar {\n        width: 5px;\n    }\n\n    ::-webkit-scrollbar-thumb {\n        background-color: #999;\n    }\n\n    ::-webkit-scrollbar-thumb:hover {\n        background-color: #ccc;\n    }\n`;\n","import 'core-js';\nimport 'normalize.css';\nimport './libs/contextmenu.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { isMobile } from './utils';\nimport { setLocale, setTranslations } from 'react-i18nify';\nimport i18n from './i18n';\nimport App from './App';\nimport Mobile from './Mobile';\nimport GlobalStyle from './GlobalStyle';\n\nsetTranslations(i18n);\nconst language = navigator.language.toLowerCase();\nconst defaultLang = i18n[language] ? language : 'en';\nsetLocale(defaultLang);\n\nReactDOM.render(\n    <React.Fragment>\n        <GlobalStyle />\n        {isMobile ? <Mobile /> : <App defaultLang={defaultLang} />}\n    </React.Fragment>,\n    document.getElementById('root'),\n);\n"],"sourceRoot":""}